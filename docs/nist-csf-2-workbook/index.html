<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NIST CSF 2.0 Self-Assessment Workbook (Unofficial)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        :root {
            --bg: #f3f4f6;
            --card: #ffffff;
            --border: #d1d5db;
            --accent: #0b61a4;
            --accent-soft: #e0f2fe;
            --accent-strong: #0b61a4;
            --text-main: #111827;
            --text-muted: #4b5563;
            --danger: #b91c1c;
            --warning: #f59e0b;
            --success: #16a34a;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top left, #dbeafe, #f3f4f6);
            color: var(--text-main);
        }

        .page {
            max-width: 1300px;
            margin: 16px auto 32px auto;
            display: grid;
            grid-template-columns: minmax(0, 2fr) minmax(300px, 1.2fr);
            gap: 16px;
            padding: 0 12px;
        }

        @media (max-width: 1000px) {
            .page {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .main-card,
        .side-card {
            background: var(--card);
            border-radius: 14px;
            box-shadow: 0 18px 40px rgba(15, 23, 42, 0.15);
            border: 1px solid rgba(148, 163, 184, 0.4);
            overflow: hidden;
        }

        .main-card-header {
            padding: 18px 20px 14px 20px;
            border-bottom: 1px solid #e5e7eb;
            background: linear-gradient(135deg, #0f172a, #1d4ed8);
            color: #f9fafb;
            position: relative;
        }

        .main-card-header::after {
            content: "";
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 10% 0%, rgba(59, 130, 246, 0.4), transparent 50%);
            opacity: 0.8;
            pointer-events: none;
        }

        .main-card-header-inner {
            position: relative;
            z-index: 1;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 3px 9px;
            border-radius: 999px;
            font-size: 11px;
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(148, 163, 184, 0.8);
            color: #e5e7eb;
            margin-bottom: 6px;
        }

        .badge span {
            font-size: 12px;
        }

        .audit-title {
            font-size: 1.4rem;
            margin: 0 0 2px 0;
            display: flex;
            align-items: baseline;
            gap: 6px;
        }

        .audit-title span {
            font-size: 0.9rem;
            font-weight: 400;
            color: #e5e7eb;
        }

        .header-sub {
            font-size: 0.83rem;
            color: #e5e7eb;
            opacity: 0.95;
        }

        .tag-row {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 6px;
            font-size: 0.78rem;
        }

        .tag {
            padding: 2px 8px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.7);
            background: rgba(15, 23, 42, 0.8);
        }

        .main-card-body {
            padding: 16px 20px 16px 20px;
        }

        .side-card-header {
            padding: 12px 14px 10px 14px;
            border-bottom: 1px solid #e5e7eb;
            background: linear-gradient(90deg, #0f172a, #1d4ed8);
            color: #f9fafb;
            position: relative;
        }

        .side-card-header h2 {
            margin: 0;
            font-size: 1rem;
        }

        .side-card-header p {
            margin: 3px 0 0 0;
            font-size: 0.78rem;
            opacity: 0.9;
        }

        .side-card-body {
            padding: 12px 14px 14px 14px;
        }

        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
            margin-bottom: 10px;
        }

        .toolbar-left,
        .toolbar-right {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
        }

        .toolbar-right {
            margin-left: auto;
        }

        @media (max-width: 700px) {
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }

            .toolbar-right {
                margin-left: 0;
                justify-content: space-between;
            }
        }

        .btn {
            border: none;
            border-radius: 999px;
            padding: 6px 14px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #e5e7eb;
            color: #111827;
        }

        .btn-primary {
            background: linear-gradient(135deg, #1d4ed8, #0b61a4);
            color: white;
            box-shadow: 0 8px 16px rgba(37, 99, 235, 0.35);
        }

        .btn-outline {
            background: transparent;
            border: 1px solid #d1d5db;
            color: #111827;
        }

        .btn-ghost {
            background: transparent;
            color: #374151;
        }

        .btn-small {
            padding: 4px 10px;
            font-size: 11px;
        }

        .btn-icon {
            width: 26px;
            height: 26px;
            border-radius: 999px;
            align-items: center;
            justify-content: center;
            padding: 0;
        }

        .btn-primary:hover {
            filter: brightness(1.05);
        }

        .btn-outline:hover {
            background: #f3f4f6;
        }

        .btn-ghost:hover {
            background: #f9fafb;
        }

        .pill {
            border-radius: 999px;
            border: 1px solid #d1d5db;
            padding: 4px 10px;
            font-size: 11px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #f9fafb;
            color: #374151;
        }

        .pill-label {
            font-weight: 600;
            color: #111827;
        }

        .pill-value {
            color: #2563eb;
        }

        .pill-dot {
            width: 8px;
            height: 8px;
            border-radius: 999px;
            background: #22c55e;
        }

        .pill-dot.warning {
            background: #f97316;
        }

        .pill-dot.danger {
            background: #ef4444;
        }

        .pill-dot.muted {
            background: #9ca3af;
        }

        .pill-soft {
            background: #eff6ff;
            border-color: #bfdbfe;
            color: #1d4ed8;
        }

        .tab-row {
            display: flex;
			flex-wrap: wrap;
			row-gap: 8px; 
            gap: 6px;
            margin-bottom: 10px;
        }

        .tab {
            flex: 0 0 auto;
            font-size: 11px;
            padding: 5px 10px;
            border-radius: 999px;
            cursor: pointer;
            border: 1px solid transparent;
            background: #f3f4f6;
            color: #4b5563;
        }

        .tab.active {
            background: #0b61a4;
            color: white;
            border-color: #0b61a4;
        }

        .section {
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            padding: 10px 12px;
            margin-bottom: 10px;
            background: #f9fafb;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 6px;
        }

        .section-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #111827;
        }

        .section-sub {
            font-size: 0.75rem;
            color: #6b7280;
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .chip {
            border-radius: 999px;
            padding: 2px 8px;
            font-size: 0.7rem;
            border: 1px solid #d1d5db;
            background: #f3f4f6;
        }

        .chip-accent {
            border-color: #bfdbfe;
            background: #e0f2fe;
            color: #075985;
        }

        .chip-soft {
            border-color: #e5e7eb;
            background: #f9fafb;
            color: #4b5563;
        }

        .inline-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 6px;
            margin-top: 6px;
        }

        .field-group {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .field-label {
            font-size: 0.72rem;
            color: #6b7280;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .field-label span {
            font-weight: 600;
            color: #111827;
        }

        .field-required {
            color: #b91c1c;
            font-size: 0.7rem;
        }

        .field-help {
            font-size: 0.7rem;
            color: #9ca3af;
        }

        input[type="text"],
        input[type="date"],
        select,
        textarea {
            font-family: inherit;
            font-size: 0.8rem;
            padding: 6px 8px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            background: white;
            color: #111827;
        }

        textarea {
            resize: vertical;
            min-height: 60px;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #1d4ed8;
            box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.35);
        }

        .small-input {
            max-width: 200px;
        }

        .micro-input {
            max-width: 100px;
        }

        .flex-row {
            display: flex;
            gap: 6px;
            align-items: center;
        }

        .flex-space {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .status-pill {
            border-radius: 999px;
            padding: 2px 8px;
            font-size: 0.72rem;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .status-pill span {
            width: 7px;
            height: 7px;
            border-radius: 999px;
        }

        .status-ok {
            background: #dcfce7;
            color: #166534;
        }

        .status-ok span {
            background: #16a34a;
        }

        .status-watch {
            background: #fef3c7;
            color: #92400e;
        }

        .status-watch span {
            background: #f59e0b;
        }

        .status-risk {
            background: #fee2e2;
            color: #b91c1c;
        }

        .status-risk span {
            background: #ef4444;
        }

        .status-neutral {
            background: #e5e7eb;
            color: #374151;
        }

        .status-neutral span {
            background: #6b7280;
        }

        .switch-row {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .switch {
            width: 34px;
            height: 18px;
            border-radius: 999px;
            background: #e5e7eb;
            position: relative;
            transition: background 0.2s;
        }

        .switch-thumb {
            position: absolute;
            width: 14px;
            height: 14px;
            border-radius: 999px;
            background: white;
            top: 2px;
            left: 2px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.25);
            transition: transform 0.2s;
        }

        .switch.on {
            background: #22c55e;
        }

        .switch.on .switch-thumb {
            transform: translateX(16px);
        }

        .check-row {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.78rem;
        }

        .check-row input[type="checkbox"] {
            width: 13px;
            height: 13px;
        }

        .side-section {
            margin-bottom: 10px;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            padding: 8px 9px 9px 9px;
            background: #f9fafb;
        }

        .side-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 6px;
            margin-bottom: 6px;
        }

        .side-section-title {
            font-size: 0.85rem;
            font-weight: 600;
        }

        .side-section-sub {
            font-size: 0.7rem;
            color: #6b7280;
        }

        .metric-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.8rem;
            margin-bottom: 4px;
        }

        .metric-label {
            color: #4b5563;
        }

        .metric-value {
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            border-radius: 999px;
            background: #e5e7eb;
            overflow: hidden;
            margin-top: 3px;
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #22c55e, #84cc16);
            border-radius: 999px;
            transition: width 0.2s ease-out;
        }

        .risk-bar {
            width: 100%;
            height: 6px;
            border-radius: 999px;
            background: #fee2e2;
            overflow: hidden;
        }

        .risk-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #f97316, #b91c1c);
            border-radius: 999px;
            transition: width 0.2s ease-out;
        }

        .phase-row {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            font-size: 0.72rem;
        }

        .phase-badge {
            padding: 2px 7px;
            border-radius: 999px;
            border: 1px solid #e5e7eb;
            background: #f9fafb;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .phase-badge span {
            font-size: 0.7rem;
            color: #6b7280;
        }

        .help-text {
            font-size: 0.7rem;
            color: #6b7280;
        }

        .help-text strong {
            color: #111827;
        }

        .list-compact {
            margin: 4px 0 0 16px;
            padding: 0;
            font-size: 0.78rem;
            color: #4b5563;
        }

        .list-compact li {
            margin-bottom: 2px;
        }

        .pill-status {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            border-radius: 999px;
            padding: 2px 8px;
            font-size: 0.72rem;
            border: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .pill-status-dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
        }

        .pill-status-ok .pill-status-dot {
            background: #16a34a;
        }

        .pill-status-warn .pill-status-dot {
            background: #f59e0b;
        }

        .pill-status-risk .pill-status-dot {
            background: #ef4444;
        }

        .pill-status-muted .pill-status-dot {
            background: #9ca3af;
        }

        .no-print {
            /* placeholder for print styles if needed */
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
            margin-bottom: 6px;
        }

        .form-row small {
            font-size: 0.72rem;
            color: #6b7280;
        }

        .audit-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 8px;
            font-size: 0.8rem;
        }

        .audit-controls label {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .audit-controls input[type="radio"] {
            width: 13px;
            height: 13px;
        }

        .small-pill {
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 999px;
            border: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .badge-soft {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 3px 8px;
            border-radius: 999px;
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            font-size: 0.72rem;
            color: #1d4ed8;
        }

        .badge-soft span {
            font-size: 0.8rem;
        }

        .key-metric {
            display: flex;
            flex-direction: column;
            gap: 2px;
            font-size: 0.78rem;
        }

        .key-metric-label {
            color: #6b7280;
        }

        .key-metric-value {
            font-weight: 600;
        }

        .table-compact {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.78rem;
            margin-top: 6px;
        }

        .table-compact th,
        .table-compact td {
            border: 1px solid #e5e7eb;
            padding: 4px 6px;
            text-align: left;
        }

        .table-compact th {
            background: #f3f4f6;
            font-weight: 600;
            font-size: 0.75rem;
        }

        .tag-soft {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 7px;
            border-radius: 999px;
            background: #eff6ff;
            color: #1d4ed8;
            font-size: 0.7rem;
        }

        .tag-soft span {
            font-size: 0.8rem;
        }

        .tag-soft.neutral {
            background: #f3f4f6;
            color: #4b5563;
        }

        .tag-soft.red {
            background: #fee2e2;
            color: #b91c1c;
        }

        .tag-soft.green {
            background: #dcfce7;
            color: #166534;
        }

        .tag-soft.yellow {
            background: #fef3c7;
            color: #92400e;
        }

        .tag-soft.blue {
            background: #dbeafe;
            color: #1d4ed8;
        }

        .text-muted {
            color: #6b7280;
            font-size: 0.78rem;
        }

        .metric-chip {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 7px;
            border-radius: 999px;
            border: 1px solid #e5e7eb;
            font-size: 0.72rem;
        }

        .metric-chip strong {
            font-weight: 600;
        }

        .metric-chip span {
            color: #6b7280;
        }

        .pill-cjis {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            border-radius: 999px;
            border: 1px solid rgba(129, 140, 248, 0.6);
            background: rgba(129, 140, 248, 0.06);
            color: #1d4ed8;
            font-size: 0.7rem;
        }

        .pill-cjis-code {
            font-weight: 600;
        }

        .pill-cjis-area {
            color: #6b7280;
        }

        .pill-cjis-dot {
            width: 6px;
            height: 6px;
            border-radius: 999px;
            background: #4f46e5;
        }

        .badge-light {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 8px;
            border-radius: 999px;
            background: #f3f4f6;
            border: 1px solid #e5e7eb;
            font-size: 0.72rem;
            color: #374151;
        }

        .badge-light span {
            font-size: 0.8rem;
        }

        .pill-text {
            font-size: 0.72rem;
            color: #6b7280;
        }

        .section-note {
            margin-top: 4px;
            font-size: 0.7rem;
            color: #6b7280;
        }

        .print-note {
            font-size: 0.7rem;
            color: #6b7280;
            margin-top: 4px;
        }

        .toast {
            position: fixed;
            bottom: 16px;
            right: 16px;
            background: #111827;
            color: #f9fafb;
            padding: 10px 14px;
            border-radius: 999px;
            font-size: 0.8rem;
            display: none;
            align-items: center;
            gap: 8px;
            box-shadow: 0 10px 30px rgba(15, 23, 42, 0.6);
            z-index: 50;
        }

        .toast.show {
            display: inline-flex;
        }

        .toast-icon {
            width: 20px;
            height: 20px;
            border-radius: 999px;
            background: #22c55e;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .toast-text {
            white-space: nowrap;
        }

        .requirement-row {
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            background: #ffffff;
            padding: 7px 8px;
            margin-bottom: 6px;
        }

        .requirement-header {
            display: flex;
            gap: 6px;
            align-items: center;
            margin-bottom: 4px;
        }

        .requirement-title {
            font-size: 0.8rem;
            font-weight: 600;
            flex: 1;
        }

        .requirement-id {
            font-size: 0.72rem;
            color: #6b7280;
        }

        .requirement-body {
            display: grid;
            grid-template-columns: minmax(0, 2.2fr) minmax(0, 2fr);
            gap: 6px;
        }

        @media (max-width: 900px) {
            .requirement-body {
                grid-template-columns: minmax(0, 1fr);
            }
        }

        .requirement-notes {
            font-size: 0.75rem;
            color: #4b5563;
        }

        .requirement-notes textarea {
            font-size: 0.75rem;
            min-height: 50px;
        }

        .requirement-controls {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .status-row {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            align-items: center;
        }

        .status-select {
            font-size: 0.75rem;
            padding: 4px 8px;
            border-radius: 999px;
            border: 1px solid #d1d5db;
            background: #f9fafb;
        }

        .evidence-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            font-size: 0.7rem;
        }

        .evidence-tag {
            padding: 2px 7px;
            border-radius: 999px;
            border: 1px dashed #cbd5f5;
            color: #4b5563;
            background: #eff6ff;
        }

        .evidence-tag strong {
            color: #1d4ed8;
        }

        .link-like {
            color: #2563eb;
            cursor: pointer;
            text-decoration: underline;
            text-decoration-style: dotted;
            font-size: 0.75rem;
        }

        .link-like:hover {
            color: #1d4ed8;
        }

        .summary-section {
            background: white;
            padding: 20px;
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.08);
            border: 1px solid #e1e5ea;
        }

        .summary-section h3 {
            font-size: 16px;
            margin-bottom: 10px;
            color: #1f2933;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
            margin-top: 10px;
        }

        .summary-card {
            background: #f8f9fa;
            padding: 14px 16px;
            border-radius: 8px;
            border-left: 4px solid #0b61a4;
            font-size: 12px;
            color: #4b5563;
        }

        .summary-card h4 {
            font-size: 13px;
            margin-bottom: 8px;
            color: #111827;
        }

        .summary-card-row {
            display: flex;
            justify-content: space-between;
            margin: 2px 0;
        }

        .summary-card-row span:first-child {
            color: #6b7280;
        }

        .summary-card-row span:last-child {
            font-weight: 600;
        }

        .summary-completion {
            margin-top: 8px;
            font-weight: 600;
            color: #111827;
            font-size: 12px;
        }

        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 40;
        }

        .modal {
            background: #f9fafb;
            border-radius: 12px;
            max-width: 620px;
            width: 94%;
            padding: 12px 16px 14px 16px;
            box-shadow: 0 20px 60px rgba(15, 23, 42, 0.6);
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .modal-title {
            font-size: 0.95rem;
            font-weight: 600;
        }

        .modal-close {
            border-radius: 999px;
            background: transparent;
            border: 1px solid #e5e7eb;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .modal-body {
            font-size: 0.8rem;
            color: #4b5563;
        }

        .modal-body h4 {
            font-size: 0.85rem;
            margin: 10px 0 3px 0;
        }

        .modal-body ul {
            margin: 3px 0 0 16px;
            padding: 0;
        }

        .modal-body li {
            margin-bottom: 2px;
        }

        .badge-inline {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 2px 7px;
            border-radius: 999px;
            font-size: 0.7rem;
            border: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .badge-inline span {
            width: 6px;
            height: 6px;
            border-radius: 999px;
        }

        .badge-inline.critical span {
            background: #b91c1c;
        }

        .badge-inline.high span {
            background: #eab308;
        }

        .badge-inline.medium span {
            background: #0ea5e9;
        }

        .badge-inline.low span {
            background: #22c55e;
        }

        .badge-inline.critical {
            color: #b91c1c;
        }

        .badge-inline.high {
            color: #92400e;
        }

        .badge-inline.medium {
            color: #075985;
        }

        .badge-inline.low {
            color: #166534;
        }

        .pill-light {
            padding: 1px 7px;
            border-radius: 999px;
            border: 1px solid #e5e7eb;
            background: #f9fafb;
            font-size: 0.7rem;
            color: #4b5563;
        }

        .text-sm {
            font-size: 0.78rem;
        }

        .mt-4 {
            margin-top: 6px;
        }

        .mt-2 {
            margin-top: 3px;
        }

        .code-inline {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 0.75rem;
            background: #f3f4f6;
            padding: 2px 4px;
            border-radius: 4px;
        }

        .indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 0.72rem;
        }

        .indicator-dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
        }

        .indicator.ok .indicator-dot {
            background: #22c55e;
        }

        .indicator.warn .indicator-dot {
            background: #facc15;
        }

        .indicator.risk .indicator-dot {
            background: #ef4444;
        }

        .indicator-label {
            color: #4b5563;
        }

        .logic-diagram {
            margin-top: 6px;
            padding: 8px 9px;
            background: #f3f4f6;
            border-radius: 8px;
            font-size: 0.75rem;
            color: #374151;
            border: 1px dashed #d1d5db;
        }

        .logic-diagram strong {
            color: #111827;
        }

        .logic-step {
            display: flex;
            gap: 4px;
            align-items: flex-start;
            margin-bottom: 2px;
        }

        .logic-step span {
            font-weight: 600;
            color: #6b7280;
        }
    </style>
</head>
<body>
<div class="page">
    <div class="main-card">
        <div class="main-card-header">
            <div class="main-card-header-inner">
                <div class="badge">
                    <span>üîê</span>
                    <span>NIST CSF 2.0 Workbook</span>
                </div>
                <h1 class="audit-title">
                    NIST Cybersecurity Framework (CSF) 2.0 Self-Assessment
                    <span>Working copy ‚Äì not an official NIST form</span>
                </h1>
                <div class="header-sub">
                    Use this page to capture assessment notes and status for a organization's CSF 2.0 readiness (plain-language guide). Progress can be saved locally, exported to JSON, or printed.
                </div>
                <div class="section" id="disclaimer" style="margin-top:10px; background:#fff7ed; border-color:#fed7aa;">
                    <div class="section-header">
                        <div class="section-title">Important: Unofficial tool + local-only storage</div>
                        <div class="section-sub"><span class="chip chip-accent">Read before use</span></div>
                    </div>
                    <div class="help-text" style="font-size:0.78rem; color:#7c2d12;">
                        <ul class="list-compact" style="color:#7c2d12; font-size:0.78rem;">
                            <li><strong>Unofficial resource:</strong> Not an official NIST workbook and not endorsed by NIST.</li>
                            <li><strong>No sensitive data:</strong> Do not enter secrets or regulated/sensitive data into this workbook.</li>
                            <li><strong>Storage:</strong> ‚ÄúSave Session‚Äù uses your browser‚Äôs <span class="code-inline">localStorage</span> on this device. It is <strong>not encrypted</strong>. Don‚Äôt use on shared/public computers.</li>
                            <li><strong>Authority:</strong> Your governing policies, auditors, and legal counsel are the authoritative sources for requirements and interpretations.</li>
                            <li><strong>Official reference:</strong> <a href="https://www.nist.gov/cyberframework" target="_blank" rel="noopener noreferrer">NIST Cybersecurity Framework (CSF)</a></li>
                        </ul>
                    </div>
                </div>

                <div class="tag-row">
                    <div class="tag">CSF Core Coverage</div>
                    <div class="tag">Cities/Counties friendly</div>
                    <div class="tag">Leadership + IT collaboration</div>
                </div>
            </div>
        </div>
        <div class="main-card-body">
            <div class="toolbar">
                <div class="toolbar-left">
                    <button class="btn btn-primary" onclick="saveState()">
                        üíæ Save Session (Browser)
                    </button>
                    <button class="btn btn-outline" onclick="resetState()">
                        ‚ôªÔ∏è Clear All
                    </button>
                    
                    <button class="btn btn-outline" onclick="exportJSON()">‚¨áÔ∏è Export JSON</button>
                    <button class="btn btn-outline" onclick="document.getElementById('importFile').click()">‚¨ÜÔ∏è Import JSON</button>
                    <input type="file" id="importFile" accept="application/json" style="display:none" onchange="importJSON(event)">
                    <button class="btn btn-ghost" onclick="window.print()">
                        üñ®Ô∏è Print / PDF Export
                    </button>
                </div>
                <div class="toolbar-right">
                    <div class="pill">
                        <div class="pill-dot" id="overallStatusDot"></div>
                        <span class="pill-label">Overall Status:</span>
                        <span class="pill-value" id="overallStatusLabel">Not started</span>
                    </div>
                    <div class="pill-soft">
                        <span>üìÖ</span>
                        <span id="lastUpdatedLabel">Last updated: not yet saved</span>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">1. Organization & Scope</div>
                    <div class="section-sub">
                        <span class="chip chip-soft">Context & identifiers</span>
                    </div>
                </div>
                <div class="inline-grid">
                    <div class="field-group">
                        <div class="field-label"><span>Agency Name</span> <span class="field-required">*</span></div>
                        <input type="text" id="agencyName" placeholder="e.g., Sample City Police Department">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>Org/Dept Identifier</span></div>
                        <input type="text" id="ori" placeholder="optional">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>State/Region (optional)</span></div>
                        <input type="text" id="csa" placeholder="e.g., Texas">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>Assessment Date</span></div>
                        <input type="date" id="assessmentDate">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>Assessor</span></div>
                        <input type="text" id="assessorName" placeholder="Name(s) of assessor(s)">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>Contact Email</span></div>
                        <input type="text" id="assessorEmail" placeholder="Primary contact for follow-up">
                    </div>
                </div>
                <div class="form-row">
                    <div class="field-group" style="flex: 2 1 260px;">
                        <div class="field-label"><span>Scope Notes</span></div>
                        <textarea id="scopeNotes"
                                  placeholder="Briefly describe scope ‚Äì systems, locations, any exclusions or special circumstances."></textarea>
                        <div class="field-help">
                            Helpful for documenting what is (and is not) in-scope: critical services, systems, cloud apps, and key vendors.
                        </div>
                    </div>
                    <div class="field-group" style="flex: 1 1 200px;">
                        <div class="field-label"><span>Assessment Type</span></div>
                        <select id="assessmentType">
                            <option value="">Select type</option>
                            <option value="self">Agency self-assessment</option>
                            <option value="preaudit">Readiness self-assessment</option>
                            <option value="csa">External audit/assessment (if applicable)</option>
                            <option value="consult">Third-party / consulting support</option>
                        </select>
                        <div class="field-help">
                            Adjust language in notes to match purpose (formal vs. informal).
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">2. Governance & Key Contacts</div>
                    <div class="section-sub">
                        <span class="chip chip-accent">Governance (GV) focus</span>
                    </div>
                </div>
                <div class="inline-grid">
                    <div class="field-group">
                        <div class="field-label"><span>IT/Security Lead (or Designee)</span></div>
                        <input type="text" id="tacName" placeholder="Name and rank/position">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>IT/Security Contact</span></div>
                        <input type="text" id="tacContact" placeholder="Phone / email">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>Security Officer / Point of Contact</span></div>
                        <input type="text" id="lasoName" placeholder="Name and rank/position">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>Security POC Contact</span></div>
                        <input type="text" id="lasoContact" placeholder="Phone / email">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>IT / ISO Lead</span></div>
                        <input type="text" id="itLead" placeholder="Name / title for IT or ISO">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>IT / ISO Contact</span></div>
                        <input type="text" id="itContact" placeholder="Phone / email">
                    </div>
                </div>
                <div class="inline-grid" style="margin-top: 6px;">
                    <div class="field-group">
                        <div class="field-label">
                            <span>Leadership & Cyber Contacts</span>
                        </div>
                        <div class="audit-controls">
                            <label><input type="radio" name="tacLasoDocs" value="present"> Documented & current</label>
                            <label><input type="radio" name="tacLasoDocs" value="partial"> Partial / needs update</label>
                            <label><input type="radio" name="tacLasoDocs" value="missing"> Not available</label>
                        </div>
                        <div class="field-help">
                            Evidence of assigned roles/responsibilities and points of contact.
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>Core Cyber Policies (plain language)</span></div>
                        <div class="audit-controls">
                            <label><input type="radio" name="localPolicy" value="aligned"> Current and documented</label>
                            <label><input type="radio" name="localPolicy" value="dated"> Outdated / needs revision</label>
                            <label><input type="radio" name="localPolicy" value="missing"> Not documented</label>
                        </div>
                    </div>
                </div>
                <div class="section-note">
                    <span class="link-like" onclick="openControlModal('governance')">View suggested governance evidence</span>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <div class="section-title">3. CSF Functions & Categories ‚Äî Assessment Items</div>
                    <div class="section-sub">
                        <span class="chip chip-accent">Functions: GV / ID / PR / DE / RS / RC</span>
                    </div>
                </div>
                <div class="help-text">
                    Use the controls below to track status by CSF Function. The main goal is to capture practical status for the organization:
                    how each control is implemented, any gaps, and follow-up actions.
                </div>
                <div class="tab-row" id="policyTabs"></div>
                <div class="tab-row" id="subgroupTabs" style="margin-top:6px;"></div>
                <div id="policyContent"></div>
            </div>

            <div class="summary-section">
                <h3>Function Summary</h3>
                <div class="summary-grid" id="summaryGrid"></div>
            </div>
        </div>
    </div>
    <div class="side-card">
        <div class="side-card-header">
            <h2>Assessment Snapshot & Notes</h2>
            <p>Quick metrics, risk overview, and planning notes for follow-up.</p>
        </div>
        <div class="side-card-body">
            <div class="side-section">
                <div class="side-section-header">
                    <div class="side-section-title">Overall Progress & Risk</div>
                    <div class="side-section-sub">
                        <span id="snapshotStatusTag" class="tag-soft neutral">Not started</span>
                    </div>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Controls with any status</span>
                    <span class="metric-value" id="metricComplete">0 / 0</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="metric-row" style="margin-top: 6px;">
                    <span class="metric-label">Subcategories rated Tier 1</span>
                    <span class="metric-value" id="metricNonCompliant">0</span>
                </div>
                <div class="risk-bar">
                    <div class="risk-fill" id="riskFill"></div>
                </div>
                <div class="phase-row" style="margin-top: 6px;">
                    <div class="phase-badge">
                        <span>1</span> Identify & scope
                    </div>
                    <div class="phase-badge">
                        <span>2</span> Gather evidence
                    </div>
                    <div class="phase-badge">
                        <span>3</span> Rate controls
                    </div>
                    <div class="phase-badge">
                        <span>4</span> Plan remediation
                    </div>
                </div>
                <div class="print-note">
                    <strong>Tip:</strong> Use this snapshot as your quick ‚Äúexecutive summary‚Äù when discussing results with organization leadership.
                </div>
            </div>

            <div class="side-section">
                <div class="side-section-header">
                    <div class="side-section-title">Environment Summary</div>
                    <div class="side-section-sub">Optional ‚Äì for context</div>
                </div>
                <div class="inline-grid">
                    <div class="field-group">
                        <div class="field-label"><span>Approximate Users</span></div>
                        <input type="text" id="approxUsers" class="micro-input" placeholder="e.g., 45">
                    </div>
                    <div class="field-group">
                        <div class="field-label"><span>Key Systems / Apps in Scope</span></div>
                        <textarea id="cjisSystems" placeholder="CAD, RMS, NCIC/TCIC terminals, JMS, Livescan, in-car MDTs, etc."></textarea>
                    </div>
                </div>
                <div class="field-group">
                    <div class="field-label"><span>High-Level Environment Notes</span></div>
                    <textarea id="environmentNotes"
                              placeholder="Network segmentation, hosted vendors, shared systems (county, city IT), physical layout, etc."></textarea>
                </div>
            </div>

            <div class="side-section">
                <div class="side-section-header">
                    <div class="side-section-title">Key Risks & Immediate Actions</div>
                    <div class="side-section-sub">For quick triage</div>
                </div>
                <div class="field-group">
                    <div class="field-label"><span>Immediate Risk Items (0‚Äì90 days)</span></div>
                    <textarea id="riskImmediate" placeholder="Summarize the most critical gaps that should be addressed first."></textarea>
                </div>
                <div class="field-group">
                    <div class="field-label"><span>Short-Term Projects (3‚Äì12 months)</span></div>
                    <textarea id="riskShortTerm" placeholder="e.g., MFA expansion, log centralization, policy updates, training backlog."></textarea>
                </div>
                <div class="field-group">
                    <div class="field-label"><span>Longer-Term Improvements</span></div>
                    <textarea id="riskLongTerm"
                              placeholder="e.g., infrastructure modernization, new CSF-compliant hosted systems, staffing changes."></textarea>
                </div>
            </div>

            <div class="side-section">
                <div class="side-section-header">
                    <div class="side-section-title">Assessor Notes</div>
                    <div class="side-section-sub">For your internal use</div>
                </div>
                <textarea id="assessorNotes" placeholder="Use this space for meta-notes about the assessment process or follow-up steps."></textarea>
            </div>
        </div>
    </div>
</div>

<div class="toast" id="toast">
    <div class="toast-icon">‚úì</div>
    <div class="toast-text" id="toastText">Saved</div>
</div>

<div class="modal-backdrop" id="controlModalBackdrop">
    <div class="modal">
        <div class="modal-header">
            <div class="modal-title" id="controlModalTitle">Control Evidence</div>
            <button class="modal-close" onclick="closeControlModal()">‚úï</button>
        </div>
        <div class="modal-body" id="controlModalBody"></div>
    </div>
</div>

<script>
    const cjisControls = {
        policyAreas: [
            {
                id: 'gv',
                title: 'GOVERN (GV)',
                policyRef: 'NIST CSF 2.0 Core',
                requirements: [
                    {
                        id: 'GV.OC-01',
                        title: 'Mission informs cyber risk',
                        summary: 'The organizational mission is understood and informs cybersecurity risk management',
                        evidence: ['Category: GV.OC ‚Äî Organizational Context', "Example: Share the organization's mission (e.g., through vision and mission statements, marketing, and service strategies) to provide a basis for identifying risks that may impede that mission"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.OC-02',
                        title: 'Stakeholders understood',
                        summary: 'Internal and external stakeholders are understood, and their needs and expectations regarding cybersecurity risk management are understood and considered',
                        evidence: ['Category: GV.OC ‚Äî Organizational Context', 'Example: Identify relevant internal stakeholders and their cybersecurity-related expectations (e.g., performance and risk expectations of leaders, directors, and advisors; cultural expectations of employees)', 'Example: Identify relevant external stakeholders and their cybersecurity-related expectations (e.g., privacy expectations of residents/customers, business expectations of partnerships, compliance expectations of regulators, ethics expectations of society)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.OC-03',
                        title: 'Requirements tracked (legal/contract)',
                        summary: 'Legal, regulatory, and contractual requirements regarding cybersecurity - including privacy and civil liberties obligations - are understood and managed',
                        evidence: ['Category: GV.OC ‚Äî Organizational Context', "Example: Determine a process to track and manage legal and regulatory requirements regarding protection of individuals' information (e.g., Health Insurance Portability and Accountability Act, California Consumer Privacy Act, General Data Protection Regulation)", 'Example: Determine a process to track and manage contractual requirements for cybersecurity management of supplier, customer, and partner information'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.OC-04',
                        title: 'Critical services identified',
                        summary: 'Critical objectives, capabilities, and services that external stakeholders depend on or expect from the organization are understood and communicated',
                        evidence: ['Category: GV.OC ‚Äî Organizational Context', 'Example: Establish criteria for determining the criticality of capabilities and services as viewed by internal and external stakeholders', 'Example: Determine (e.g., from a business impact analysis) assets and business operations that are vital to achieving mission objectives and the potential impact of a loss (or partial loss) of such operations'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.OC-05',
                        title: 'Dependencies identified',
                        summary: 'Outcomes, capabilities, and services that the organization depends on are understood and communicated',
                        evidence: ['Category: GV.OC ‚Äî Organizational Context', "Example: Create an inventory of the organization's dependencies on external resources (e.g., facilities, cloud-based hosting providers) and their relationships to organizational assets and business functions", "Example: Identify and document external dependencies that are potential points of failure for the organization's critical capabilities and services, and share that information with appropriate personnel"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.OV-01',
                        title: 'Cyber risk strategy outcomes are reviewed t‚Ä¶',
                        summary: 'Cybersecurity risk management strategy outcomes are reviewed to inform and adjust strategy and direction',
                        evidence: ['Category: GV.OV ‚Äî Oversight', 'Example: Measure how well the risk management strategy and risk results have helped leaders make decisions and achieve organizational objectives', 'Example: Examine whether cybersecurity risk strategies that impede operations or innovation should be adjusted'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.OV-02',
                        title: 'Cyber risk strategy is reviewed and adjuste‚Ä¶',
                        summary: 'The cybersecurity risk management strategy is reviewed and adjusted to ensure coverage of organizational requirements and risks',
                        evidence: ['Category: GV.OV ‚Äî Oversight', 'Example: Review audit findings to confirm whether the existing cybersecurity strategy has ensured compliance with internal and external requirements', 'Example: Review the performance oversight of those in cybersecurity-related roles to determine whether policy changes are necessary'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.OV-03',
                        title: 'Organizational cyber risk performance is ev‚Ä¶',
                        summary: 'Organizational cybersecurity risk management performance is evaluated and reviewed for adjustments needed',
                        evidence: ['Category: GV.OV ‚Äî Oversight', 'Example: Review key performance indicators (KPIs) to ensure that organization-wide policies and procedures achieve objectives', 'Example: Review key risk indicators (KRIs) to identify risks the organization faces, including likelihood and potential impact'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.PO-01',
                        title: 'Policy for managing cybersecurity risks is‚Ä¶',
                        summary: 'Policy for managing cybersecurity risks is established based on organizational context, cybersecurity strategy, and priorities and is communicated and enforced',
                        evidence: ['Category: GV.PO ‚Äî Policy', 'Example: Create, disseminate, and maintain an understandable, usable risk management policy with statements of management intent, expectations, and direction', 'Example: Periodically review policy and supporting processes and procedures to ensure that they align with risk management strategy objectives and priorities, as well as the high-level direction of the cybersecurity policy'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.PO-02',
                        title: 'Policy for managing cybersecurity risks is‚Ä¶',
                        summary: 'Policy for managing cybersecurity risks is reviewed, updated, communicated, and enforced to reflect changes in requirements, threats, technology, and organizational mission',
                        evidence: ['Category: GV.PO ‚Äî Policy', 'Example: Update policy based on periodic reviews of cybersecurity risk management results to ensure that policy and supporting processes and procedures adequately maintain risk at an acceptable level', "Example: Provide a timeline for reviewing changes to the organization's risk environment (e.g., changes in risk or in the organization's mission objectives), and communicate recommended policy updates"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RM-01',
                        title: 'Risk management objectives are established‚Ä¶',
                        summary: 'Risk management objectives are established and agreed to by organizational stakeholders',
                        evidence: ['Category: GV.RM ‚Äî Risk Management Strategy', 'Example: Update near-term and long-term cybersecurity risk management objectives as part of annual strategic planning and when major changes occur', 'Example: Establish measurable objectives for cybersecurity risk management (e.g., manage the quality of user training, ensure adequate risk protection for industrial control systems)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RM-02',
                        title: 'Risk appetite and risk tolerance statements‚Ä¶',
                        summary: 'Risk appetite and risk tolerance statements are established, communicated, and maintained',
                        evidence: ['Category: GV.RM ‚Äî Risk Management Strategy', 'Example: Determine and communicate risk appetite statements that convey expectations about the appropriate level of risk for the organization', 'Example: Translate risk appetite statements into specific, measurable, and broadly understandable risk tolerance statements'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RM-03',
                        title: 'Cyber risk activities and outcomes are incl‚Ä¶',
                        summary: 'Cybersecurity risk management activities and outcomes are included in enterprise risk management processes',
                        evidence: ['Category: GV.RM ‚Äî Risk Management Strategy', 'Example: Aggregate and manage cybersecurity risks alongside other enterprise risks (e.g., compliance, financial, operational, regulatory, reputational, safety)', 'Example: Include cybersecurity risk managers in enterprise risk management planning'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RM-04',
                        title: 'Strategic direction that describes appropri‚Ä¶',
                        summary: 'Strategic direction that describes appropriate risk response options is established and communicated',
                        evidence: ['Category: GV.RM ‚Äî Risk Management Strategy', 'Example: Specify criteria for accepting and avoiding cybersecurity risk for various classifications of data', 'Example: Determine whether to purchase cybersecurity insurance'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RM-05',
                        title: 'Lines of communication across the organizat‚Ä¶',
                        summary: 'Lines of communication across the organization are established for cybersecurity risks, including risks from suppliers and other third parties',
                        evidence: ['Category: GV.RM ‚Äî Risk Management Strategy', "Example: Determine how to update senior executives, directors, and management on the organization's cybersecurity posture at agreed-upon intervals", 'Example: Identify how all departments across the organization - such as management, operations, internal auditors, legal, acquisition, physical security, and HR - will communicate with each other about cybersecurity risks'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RM-06',
                        title: 'A standardized method for calculating, docu‚Ä¶',
                        summary: 'A standardized method for calculating, documenting, categorizing, and prioritizing cybersecurity risks is established and communicated',
                        evidence: ['Category: GV.RM ‚Äî Risk Management Strategy', 'Example: Establish criteria for using a quantitative approach to cybersecurity risk analysis, and specify probability and exposure formulas', 'Example: Create and use templates (e.g., a risk register) to document cybersecurity risk information (e.g., risk description, exposure, treatment, and ownership)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RM-07',
                        title: 'Strategic opportunities (i.e., positive ris‚Ä¶',
                        summary: 'Strategic opportunities (i.e., positive risks) are characterized and are included in organizational cybersecurity risk discussions',
                        evidence: ['Category: GV.RM ‚Äî Risk Management Strategy', 'Example: Define and communicate guidance and methods for identifying opportunities and including them in risk discussions (e.g., strengths, weaknesses, opportunities, and threats [SWOT] analysis)', 'Example: Identify stretch goals and document them'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RR-01',
                        title: 'Organizational leadership is responsible an‚Ä¶',
                        summary: 'Organizational leadership is responsible and accountable for cybersecurity risk and fosters a culture that is risk-aware, ethical, and continually improving',
                        evidence: ['Category: GV.RR ‚Äî Roles, Responsibilities, and Authorities', "Example: Leaders (e.g., directors) agree on their roles and responsibilities in developing, implementing, and assessing the organization's cybersecurity strategy", "Example: Share leaders' expectations regarding a secure and ethical culture, especially when current events present the opportunity to highlight positive or negative examples of cybersecurity risk management"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RR-02',
                        title: 'Roles, responsibilities, and authorities re‚Ä¶',
                        summary: 'Roles, responsibilities, and authorities related to cybersecurity risk management are established, communicated, understood, and enforced',
                        evidence: ['Category: GV.RR ‚Äî Roles, Responsibilities, and Authorities', 'Example: Document risk management roles and responsibilities in policy', 'Example: Document who is responsible and accountable for cybersecurity risk management activities and how those teams and individuals are to be consulted and informed'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RR-03',
                        title: 'Adequate resources are allocated commensura‚Ä¶',
                        summary: 'Adequate resources are allocated commensurate with the cybersecurity risk strategy, roles, responsibilities, and policies',
                        evidence: ['Category: GV.RR ‚Äî Roles, Responsibilities, and Authorities', 'Example: Conduct periodic management reviews to ensure that those given cybersecurity risk management responsibilities have the necessary authority', 'Example: Identify resource allocation and investment in line with risk tolerance and response'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.RR-04',
                        title: 'Cybersecurity is included in human resource‚Ä¶',
                        summary: 'Cybersecurity is included in human resources practices',
                        evidence: ['Category: GV.RR ‚Äî Roles, Responsibilities, and Authorities', 'Example: Integrate cybersecurity risk management considerations into human resources processes (e.g., personnel screening, onboarding, change notification, offboarding)', 'Example: Consider cybersecurity knowledge to be a positive factor in hiring, training, and retention decisions'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-01',
                        title: 'A cybersecurity supply chain risk managemen‚Ä¶',
                        summary: 'A cybersecurity supply chain risk management program, strategy, objectives, policies, and processes are established and agreed to by organizational stakeholders',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', 'Example: Establish a strategy that expresses the objectives of the cybersecurity supply chain risk management program', 'Example: Develop the cybersecurity supply chain risk management program, including a plan (with milestones), policies, and procedures that guide implementation and improvement of the program, and share the policies and procedures with the organizational stakeholders'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-02',
                        title: 'Cybersecurity roles and responsibilities fo‚Ä¶',
                        summary: 'Cybersecurity roles and responsibilities for suppliers, customers, and partners are established, communicated, and coordinated internally and externally',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', 'Example: Identify one or more specific roles or positions that will be responsible and accountable for planning, resourcing, and executing cybersecurity supply chain risk management activities', 'Example: Document cybersecurity supply chain risk management roles and responsibilities in policy'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-03',
                        title: 'Cybersecurity supply chain risk management‚Ä¶',
                        summary: 'Cybersecurity supply chain risk management is integrated into cybersecurity and enterprise risk management, risk assessment, and improvement processes',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', 'Example: Identify areas of alignment and overlap with cybersecurity and enterprise risk management', 'Example: Establish integrated control sets for cybersecurity risk management and cybersecurity supply chain risk management'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-04',
                        title: 'Suppliers are known and prioritized by crit‚Ä¶',
                        summary: 'Suppliers are known and prioritized by criticality',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', "Example: Develop criteria for supplier criticality based on, for example, the sensitivity of data processed or possessed by suppliers, the degree of access to the organization's systems, and the importance of the products or services to the organization's mission", 'Example: Keep a record of all suppliers, and prioritize suppliers based on the criticality criteria'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-05',
                        title: 'Requirements to address cybersecurity risks‚Ä¶',
                        summary: 'Requirements to address cybersecurity risks in supply chains are established, prioritized, and integrated into contracts and other types of agreements with suppliers and other relevant third parties',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', 'Example: Establish security requirements for suppliers, products, and services commensurate with their criticality level and potential impact if compromised', 'Example: Include all cybersecurity and supply chain requirements that third parties must follow and how compliance with the requirements may be verified in default contractual language'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-06',
                        title: 'Planning and due diligence are performed to‚Ä¶',
                        summary: 'Planning and due diligence are performed to reduce risks before entering into formal supplier or other third-party relationships',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', 'Example: Perform thorough due diligence on prospective suppliers that is consistent with procurement planning and commensurate with the level of risk, criticality, and complexity of each supplier relationship', 'Example: Assess the suitability of the technology and cybersecurity capabilities and the risk management practices of prospective suppliers'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-07',
                        title: 'Risks posed by a supplier, their products a‚Ä¶',
                        summary: 'The risks posed by a supplier, their products and services, and other third parties are understood, recorded, prioritized, assessed, responded to, and monitored over the course of the relationship',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', "Example: Adjust assessment formats and frequencies based on the third party's reputation and the criticality of the products or services they provide", "Example: Evaluate third parties' evidence of compliance with contractual cybersecurity requirements, such as self-attestations, warranties, certifications, and other artifacts"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-08',
                        title: 'Relevant suppliers and other third parties‚Ä¶',
                        summary: 'Relevant suppliers and other third parties are included in incident planning, response, and recovery activities',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', 'Example: Define and use rules and protocols for reporting incident response and recovery activities and the status between the organization and its suppliers', 'Example: Identify and document the roles and responsibilities of the organization and its suppliers for incident response'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-09',
                        title: 'Supply chain security practices are integra‚Ä¶',
                        summary: 'Supply chain security practices are integrated into cybersecurity and enterprise risk management programs, and their performance is monitored throughout the technology product and service life cycle',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', 'Example: Policies and procedures require provenance records for all acquired technology products and services', 'Example: Periodically provide risk reporting to leaders about how acquired components are proven to be untampered and authentic'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'GV.SC-10',
                        title: 'Cybersecurity supply chain risk management‚Ä¶',
                        summary: 'Cybersecurity supply chain risk management plans include provisions for activities that occur after the conclusion of a partnership or service agreement',
                        evidence: ['Category: GV.SC ‚Äî Cybersecurity Supply Chain Risk Management', 'Example: Establish processes for terminating critical relationships under both normal and adverse circumstances', 'Example: Define and implement plans for component end-of-life maintenance support and obsolescence'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    }
                ]
            },
            {
                id: 'id',
                title: 'IDENTIFY (ID)',
                policyRef: 'NIST CSF 2.0 Core',
                requirements: [
                    {
                        id: 'ID.AM-01',
                        title: 'Inventories of hardware managed by the orga‚Ä¶',
                        summary: 'Inventories of hardware managed by the organization are maintained',
                        evidence: ['Category: ID.AM ‚Äî Asset Management', 'Example: Maintain inventories for all types of hardware, including IT, IoT, OT, and mobile devices', 'Example: Constantly monitor networks to detect new hardware and automatically update inventories'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.AM-02',
                        title: 'Inventories of software, services, and syst‚Ä¶',
                        summary: 'Inventories of software, services, and systems managed by the organization are maintained',
                        evidence: ['Category: ID.AM ‚Äî Asset Management', 'Example: Maintain inventories for all types of software and services, including commercial-off-the-shelf, open-source, custom applications, API services, and cloud-based applications and services', 'Example: Constantly monitor all platforms, including containers and virtual machines, for software and service inventory changes'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.AM-03',
                        title: "Representations of the organization's autho‚Ä¶",
                        summary: "Representations of the organization's authorized network communication and internal and external network data flows are maintained",
                        evidence: ['Category: ID.AM ‚Äî Asset Management', "Example: Maintain baselines of communication and data flows within the organization's wired and wireless networks", 'Example: Maintain baselines of communication and data flows between the organization and third parties'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.AM-04',
                        title: 'Inventories of services provided by supplie‚Ä¶',
                        summary: 'Inventories of services provided by suppliers are maintained',
                        evidence: ['Category: ID.AM ‚Äî Asset Management', 'Example: Inventory all external services used by the organization, including third-party infrastructure-as-a-service (IaaS), platform-as-a-service (PaaS), and software-as-a-service (SaaS) offerings; APIs; and other externally hosted application services', "Example: Update the inventory when a new external service is going to be utilized to ensure adequate cybersecurity risk management monitoring of the organization's use of that service"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.AM-05',
                        title: 'Assets are prioritized based on classificat‚Ä¶',
                        summary: 'Assets are prioritized based on classification, criticality, resources, and impact on the mission',
                        evidence: ['Category: ID.AM ‚Äî Asset Management', 'Example: Define criteria for prioritizing each class of assets', 'Example: Apply the prioritization criteria to assets'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.AM-06',
                        title: '[Withdrawn: Incorporated into GV.RR-02, GV.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.RR-02, GV.SC-02]',
                        evidence: ['Category: ID.AM ‚Äî Asset Management', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.AM-07',
                        title: 'Inventories of data and corresponding metad‚Ä¶',
                        summary: 'Inventories of data and corresponding metadata for designated data types are maintained',
                        evidence: ['Category: ID.AM ‚Äî Asset Management', 'Example: Maintain a list of the designated data types of interest (e.g., personally identifiable information, protected health information, financial account numbers, organization intellectual property, operational technology data)', 'Example: Continuously discover and analyze ad hoc data to identify new instances of designated data types'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.AM-08',
                        title: 'Systems, hardware, software, services, and‚Ä¶',
                        summary: 'Systems, hardware, software, services, and data are managed throughout their life cycles',
                        evidence: ['Category: ID.AM ‚Äî Asset Management', 'Example: Integrate cybersecurity considerations throughout the life cycles of systems, hardware, software, and services', 'Example: Integrate cybersecurity considerations into product life cycles'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.BE-01',
                        title: '[Withdrawn: Incorporated into GV.OC-05]',
                        summary: '[Withdrawn: Incorporated into GV.OC-05]',
                        evidence: ['Category: ID.BE ‚Äî Business Environment', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.BE-02',
                        title: '[Withdrawn: Incorporated into GV.OC-01]',
                        summary: '[Withdrawn: Incorporated into GV.OC-01]',
                        evidence: ['Category: ID.BE ‚Äî Business Environment', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.BE-03',
                        title: '[Withdrawn: Incorporated into GV.OC-01]',
                        summary: '[Withdrawn: Incorporated into GV.OC-01]',
                        evidence: ['Category: ID.BE ‚Äî Business Environment', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.BE-04',
                        title: '[Withdrawn: Incorporated into GV.OC-04, GV.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.OC-04, GV.OC-05]',
                        evidence: ['Category: ID.BE ‚Äî Business Environment', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.BE-05',
                        title: '[Withdrawn: Incorporated into GV.OC-04]',
                        summary: '[Withdrawn: Incorporated into GV.OC-04]',
                        evidence: ['Category: ID.BE ‚Äî Business Environment', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.GV-01',
                        title: '[Withdrawn: Incorporated into GV.PO, GV.PO-‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.PO, GV.PO-01, GV.PO-02]',
                        evidence: ['Category: ID.GV ‚Äî Governance', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.GV-02',
                        title: '[Withdrawn: Incorporated into GV.OC-02, GV.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.OC-02, GV.RR, GV.RR-02]',
                        evidence: ['Category: ID.GV ‚Äî Governance', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.GV-03',
                        title: '[Withdrawn: Moved to GV.OC-03]',
                        summary: '[Withdrawn: Moved to GV.OC-03]',
                        evidence: ['Category: ID.GV ‚Äî Governance', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.GV-04',
                        title: '[Withdrawn: Moved to GV.RM-04]',
                        summary: '[Withdrawn: Moved to GV.RM-04]',
                        evidence: ['Category: ID.GV ‚Äî Governance', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.IM-01',
                        title: 'Improvements are identified from evaluations',
                        summary: 'Improvements are identified from evaluations',
                        evidence: ['Category: ID.IM ‚Äî Improvement', 'Example: Perform self-assessments of critical services that take current threats and TTPs into consideration', "Example: Invest in third-party assessments or independent audits of the effectiveness of the organization's cybersecurity program to identify areas that need improvement"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.IM-02',
                        title: 'Improvements are identified from security t‚Ä¶',
                        summary: 'Improvements are identified from security tests and exercises, including those done in coordination with suppliers and relevant third parties',
                        evidence: ['Category: ID.IM ‚Äî Improvement', 'Example: Identify improvements for future incident response activities based on findings from incident response assessments (e.g., tabletop exercises and simulations, tests, internal reviews, independent audits)', 'Example: Identify improvements for future business continuity, disaster recovery, and incident response activities based on exercises performed in coordination with critical service providers and product suppliers'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.IM-03',
                        title: 'Improvements are identified from execution‚Ä¶',
                        summary: 'Improvements are identified from execution of operational processes, procedures, and activities',
                        evidence: ['Category: ID.IM ‚Äî Improvement', 'Example: Conduct collaborative lessons learned sessions with suppliers', 'Example: Annually review cybersecurity policies, processes, and procedures to take lessons learned into account'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.IM-04',
                        title: 'Incident response plans and other cybersecu‚Ä¶',
                        summary: 'Incident response plans and other cybersecurity plans that affect operations are established, communicated, maintained, and improved',
                        evidence: ['Category: ID.IM ‚Äî Improvement', "Example: Establish contingency plans (e.g., incident response, business continuity, disaster recovery) for responding to and recovering from adverse events that can interfere with operations, expose confidential information, or otherwise endanger the organization's mission and viability", 'Example: Include contact and communication information, processes for handling common scenarios, and criteria for prioritization, escalation, and elevation in all contingency plans'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-01',
                        title: 'Vulnerabilities in assets are identified, v‚Ä¶',
                        summary: 'Vulnerabilities in assets are identified, validated, and recorded',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Use vulnerability management technologies to identify unpatched and misconfigured software', 'Example: Assess network and system architectures for design and implementation weaknesses that affect cybersecurity'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-02',
                        title: 'Cyber threat intelligence is received from‚Ä¶',
                        summary: 'Cyber threat intelligence is received from information sharing forums and sources',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Configure cybersecurity tools and technologies with detection or response capabilities to securely ingest cyber threat intelligence feeds', 'Example: Receive and review advisories from reputable third parties on current threat actors and their tactics, techniques, and procedures (TTPs)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-03',
                        title: 'Internal and external threats to the organi‚Ä¶',
                        summary: 'Internal and external threats to the organization are identified and recorded',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Use cyber threat intelligence to maintain awareness of the types of threat actors likely to target the organization and the TTPs they are likely to use', 'Example: Perform threat hunting to look for signs of threat actors within the environment'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-04',
                        title: 'Potential impacts and likelihoods of threat‚Ä¶',
                        summary: 'Potential impacts and likelihoods of threats exploiting vulnerabilities are identified and recorded',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Business leaders and cybersecurity risk management practitioners work together to estimate the likelihood and impact of risk scenarios and record them in risk registers', "Example: Enumerate the potential business impacts of unauthorized access to the organization's communications, systems, and data processed in or by those systems"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-05',
                        title: 'Threats, vulnerabilities, likelihoods, and‚Ä¶',
                        summary: 'Threats, vulnerabilities, likelihoods, and impacts are used to understand inherent risk and inform risk response prioritization',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Develop threat models to better understand risks to the data and identify appropriate risk responses', 'Example: Prioritize cybersecurity resource allocations and investments based on estimated likelihoods and impacts'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-06',
                        title: 'Risk responses are chosen, prioritized, pla‚Ä¶',
                        summary: 'Risk responses are chosen, prioritized, planned, tracked, and communicated',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', "Example: Apply the vulnerability management plan's criteria for deciding whether to accept, transfer, mitigate, or avoid risk", "Example: Apply the vulnerability management plan's criteria for selecting compensating controls to mitigate risk"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-07',
                        title: 'Changes and exceptions are managed, assesse‚Ä¶',
                        summary: 'Changes and exceptions are managed, assessed for risk impact, recorded, and tracked',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Implement and follow procedures for the formal documentation, review, testing, and approval of proposed changes and requested exceptions', 'Example: Document the possible risks of making or not making each proposed change, and provide guidance on rolling back changes'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-08',
                        title: 'Processes for receiving, analyzing, and res‚Ä¶',
                        summary: 'Processes for receiving, analyzing, and responding to vulnerability disclosures are established',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Conduct vulnerability information sharing between the organization and its suppliers following the rules and protocols defined in contracts', 'Example: Assign responsibilities and verify the execution of procedures for processing, analyzing the impact of, and responding to cybersecurity threat, vulnerability, or incident disclosures by suppliers, residents/customers, partners, and government cybersecurity organizations'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-09',
                        title: 'Authenticity and integrity of hardware and‚Ä¶',
                        summary: 'The authenticity and integrity of hardware and software are assessed prior to acquisition and use',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Assess the authenticity and cybersecurity of critical technology products and services prior to acquisition and use'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RA-10',
                        title: 'Critical suppliers are assessed prior to ac‚Ä¶',
                        summary: 'Critical suppliers are assessed prior to acquisition',
                        evidence: ['Category: ID.RA ‚Äî Risk Assessment', 'Example: Conduct supplier risk assessments against business and applicable cybersecurity requirements, including the supply chain'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RM-01',
                        title: '[Withdrawn: Incorporated into GV.RM-01, GV.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.RM-01, GV.RM-06, GV.RR-03]',
                        evidence: ['Category: ID.RM ‚Äî Risk Management Strategy', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RM-02',
                        title: '[Withdrawn: Incorporated into GV.RM-02, GV.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.RM-02, GV.RM-04]',
                        evidence: ['Category: ID.RM ‚Äî Risk Management Strategy', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.RM-03',
                        title: '[Withdrawn: Moved into GV.RM-02]',
                        summary: '[Withdrawn: Moved into GV.RM-02]',
                        evidence: ['Category: ID.RM ‚Äî Risk Management Strategy', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.SC-01',
                        title: '[Withdrawn: Incorporated into GV.RM-05, GV.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.RM-05, GV.SC-01, GV.SC-06, GV.SC-09, GV.SC-10]',
                        evidence: ['Category: ID.SC ‚Äî Supply Chain Risk Management', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.SC-02',
                        title: '[Withdrawn: Incorporated into GV.OC-02, GV.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.OC-02, GV.SC-03, GV.SC-04, GV.SC-07, ID.RA-10]',
                        evidence: ['Category: ID.SC ‚Äî Supply Chain Risk Management', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.SC-03',
                        title: '[Withdrawn: Moved to GV.SC-05]',
                        summary: '[Withdrawn: Moved to GV.SC-05]',
                        evidence: ['Category: ID.SC ‚Äî Supply Chain Risk Management', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.SC-04',
                        title: '[Withdrawn: Incorporated into GV.SC-07, ID.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.SC-07, ID.RA-10]',
                        evidence: ['Category: ID.SC ‚Äî Supply Chain Risk Management', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'ID.SC-05',
                        title: '[Withdrawn: Incorporated into GV.SC-08, ID.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into GV.SC-08, ID.IM-02]',
                        evidence: ['Category: ID.SC ‚Äî Supply Chain Risk Management', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    }
                ]
            },
            {
                id: 'pr',
                title: 'PROTECT (PR)',
                policyRef: 'NIST CSF 2.0 Core',
                requirements: [
                    {
                        id: 'PR.AA-01',
                        title: 'Identities and credentials for authorized u‚Ä¶',
                        summary: 'Identities and credentials for authorized users, services, and hardware are managed by the organization',
                        evidence: ['Category: PR.AA ‚Äî Identity Management, Authentication, and Access Control', 'Example: Initiate requests for new access or additional access for employees, contractors, and others, and track, review, and fulfill the requests, with permission from system or data owners when needed', 'Example: Issue, manage, and revoke cryptographic certificates and identity tokens, cryptographic keys (i.e., key management), and other credentials'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AA-02',
                        title: 'Identities are proofed and bound to credent‚Ä¶',
                        summary: 'Identities are proofed and bound to credentials based on the context of interactions',
                        evidence: ['Category: PR.AA ‚Äî Identity Management, Authentication, and Access Control', "Example: Verify a person's claimed identity at enrollment time using government-issued identity credentials (e.g., passport, visa, driver's license)", 'Example: Issue a different credential for each person (i.e., no credential sharing)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AA-03',
                        title: 'Users, services, and hardware are authentic‚Ä¶',
                        summary: 'Users, services, and hardware are authenticated',
                        evidence: ['Category: PR.AA ‚Äî Identity Management, Authentication, and Access Control', 'Example: Require multifactor authentication', 'Example: Enforce policies for the minimum strength of passwords, PINs, and similar authenticators'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AA-04',
                        title: 'Identity assertions are protected, conveyed‚Ä¶',
                        summary: 'Identity assertions are protected, conveyed, and verified',
                        evidence: ['Category: PR.AA ‚Äî Identity Management, Authentication, and Access Control', 'Example: Protect identity assertions that are used to convey authentication and user information through single sign-on systems', 'Example: Protect identity assertions that are used to convey authentication and user information between federated systems'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AA-05',
                        title: 'Access permissions, entitlements, and autho‚Ä¶',
                        summary: 'Access permissions, entitlements, and authorizations are defined in a policy, managed, enforced, and reviewed, and incorporate the principles of least privilege and separation of duties',
                        evidence: ['Category: PR.AA ‚Äî Identity Management, Authentication, and Access Control', 'Example: Review logical and physical access privileges periodically and whenever someone changes roles or leaves the organization, and promptly rescind privileges that are no longer needed', "Example: Take attributes of the requester and the requested resource into account for authorization decisions (e.g., geolocation, day/time, requester endpoint's cyber health)"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AA-06',
                        title: 'Physical access to assets is managed, monit‚Ä¶',
                        summary: 'Physical access to assets is managed, monitored, and enforced commensurate with risk',
                        evidence: ['Category: PR.AA ‚Äî Identity Management, Authentication, and Access Control', 'Example: Use security guards, security cameras, locked entrances, alarm systems, and other physical controls to monitor facilities and restrict access', 'Example: Employ additional physical security controls for areas that contain high-risk assets'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AC-01',
                        title: '[Withdrawn: Incorporated into PR.AA-01, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into PR.AA-01, PR.AA-05]',
                        evidence: ['Category: PR.AC ‚Äî Identity Management, Authentication and Access Control', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AC-02',
                        title: '[Withdrawn: Moved to PR.AA-06]',
                        summary: '[Withdrawn: Moved to PR.AA-06]',
                        evidence: ['Category: PR.AC ‚Äî Identity Management, Authentication and Access Control', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AC-03',
                        title: '[Withdrawn: Incorporated into PR.AA-03, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into PR.AA-03, PR.AA-05, PR.IR-01]',
                        evidence: ['Category: PR.AC ‚Äî Identity Management, Authentication and Access Control', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AC-04',
                        title: '[Withdrawn: Moved to PR.AA-05]',
                        summary: '[Withdrawn: Moved to PR.AA-05]',
                        evidence: ['Category: PR.AC ‚Äî Identity Management, Authentication and Access Control', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AC-05',
                        title: '[Withdrawn: Incorporated into PR.IR-01]',
                        summary: '[Withdrawn: Incorporated into PR.IR-01]',
                        evidence: ['Category: PR.AC ‚Äî Identity Management, Authentication and Access Control', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AC-06',
                        title: '[Withdrawn: Moved to PR.AA-02]',
                        summary: '[Withdrawn: Moved to PR.AA-02]',
                        evidence: ['Category: PR.AC ‚Äî Identity Management, Authentication and Access Control', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AC-07',
                        title: '[Withdrawn: Moved to PR.AA-03]',
                        summary: '[Withdrawn: Moved to PR.AA-03]',
                        evidence: ['Category: PR.AC ‚Äî Identity Management, Authentication and Access Control', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AT-01',
                        title: 'Personnel are provided with awareness and t‚Ä¶',
                        summary: 'Personnel are provided with awareness and training so that they possess the knowledge and skills to perform general tasks with cybersecurity risks in mind',
                        evidence: ['Category: PR.AT ‚Äî Awareness and Training', "Example: Provide basic cybersecurity awareness and training to employees, contractors, partners, suppliers, and all other users of the organization's non-public resources", 'Example: Train personnel to recognize social engineering attempts and other common attacks, report attacks and suspicious activity, comply with acceptable use policies, and perform basic cyber hygiene tasks (e.g., patching software, choosing passwords, protecting credentials)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AT-02',
                        title: 'Individuals in specialized roles are provid‚Ä¶',
                        summary: 'Individuals in specialized roles are provided with awareness and training so that they possess the knowledge and skills to perform relevant tasks with cybersecurity risks in mind',
                        evidence: ['Category: PR.AT ‚Äî Awareness and Training', 'Example: Identify the specialized roles within the organization that require additional cybersecurity training, such as physical and cybersecurity personnel, finance personnel, senior leadership, and anyone with access to business-critical data', 'Example: Provide role-based cybersecurity awareness and training to all those in specialized roles, including contractors, partners, suppliers, and other third parties'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AT-03',
                        title: '[Withdrawn: Incorporated into PR.AT-01, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into PR.AT-01, PR.AT-02]',
                        evidence: ['Category: PR.AT ‚Äî Awareness and Training', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AT-04',
                        title: '[Withdrawn: Incorporated into PR.AT-02]',
                        summary: '[Withdrawn: Incorporated into PR.AT-02]',
                        evidence: ['Category: PR.AT ‚Äî Awareness and Training', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.AT-05',
                        title: '[Withdrawn: Incorporated into PR.AT-02]',
                        summary: '[Withdrawn: Incorporated into PR.AT-02]',
                        evidence: ['Category: PR.AT ‚Äî Awareness and Training', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-01',
                        title: 'Confidentiality, integrity, and availabilit‚Ä¶',
                        summary: 'The confidentiality, integrity, and availability of data-at-rest are protected',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: Use encryption, digital signatures, and cryptographic hashes to protect the confidentiality and integrity of stored data in files, databases, virtual machine disk images, container images, and other resources', 'Example: Use full disk encryption to protect data stored on user endpoints'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-02',
                        title: 'Confidentiality, integrity, and availabilit‚Ä¶',
                        summary: 'The confidentiality, integrity, and availability of data-in-transit are protected',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: Use encryption, digital signatures, and cryptographic hashes to protect the confidentiality and integrity of network communications', 'Example: Automatically encrypt or block outbound emails and other communications that contain sensitive data, depending on the data classification'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-03',
                        title: '[Withdrawn: Incorporated into ID.AM-08, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.AM-08, PR.PS-03]',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-04',
                        title: '[Withdrawn: Moved to PR.IR-04]',
                        summary: '[Withdrawn: Moved to PR.IR-04]',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-05',
                        title: '[Withdrawn: Incorporated into PR.DS-01, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into PR.DS-01, PR.DS-02, PR.DS-10]',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-06',
                        title: '[Withdrawn: Incorporated into PR.DS-01, DE.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into PR.DS-01, DE.CM-09]',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-07',
                        title: '[Withdrawn: Incorporated into PR.IR-01]',
                        summary: '[Withdrawn: Incorporated into PR.IR-01]',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-08',
                        title: '[Withdrawn: Incorporated into ID.RA-09, DE.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.RA-09, DE.CM-09]',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-10',
                        title: 'Confidentiality, integrity, and availabilit‚Ä¶',
                        summary: 'The confidentiality, integrity, and availability of data-in-use are protected',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: Remove data that must remain confidential (e.g., from processors and memory) as soon as it is no longer needed', 'Example: Protect data in use from access by other users and processes of the same platform'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.DS-11',
                        title: 'Backups of data are created, protected, mai‚Ä¶',
                        summary: 'Backups of data are created, protected, maintained, and tested',
                        evidence: ['Category: PR.DS ‚Äî Data Security', 'Example: Continuously back up critical data in near-real-time, and back up other data frequently at agreed-upon schedules', 'Example: Test backups and restores for all types of data sources at least annually'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-01',
                        title: '[Withdrawn: Incorporated into PR.PS-01]',
                        summary: '[Withdrawn: Incorporated into PR.PS-01]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-02',
                        title: '[Withdrawn: Incorporated into ID.AM-08, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.AM-08, PR.PS-06]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-03',
                        title: '[Withdrawn: Incorporated into PR.PS-01, ID.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into PR.PS-01, ID.RA-07]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-04',
                        title: '[Withdrawn: Moved to PR.DS-11]',
                        summary: '[Withdrawn: Moved to PR.DS-11]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-05',
                        title: '[Withdrawn: Moved to PR.IR-02]',
                        summary: '[Withdrawn: Moved to PR.IR-02]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-06',
                        title: '[Withdrawn: Incorporated into ID.AM-08]',
                        summary: '[Withdrawn: Incorporated into ID.AM-08]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-07',
                        title: '[Withdrawn: Incorporated into ID.IM, ID.IM-‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.IM, ID.IM-03]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-08',
                        title: '[Withdrawn: Moved to ID.IM-03]',
                        summary: '[Withdrawn: Moved to ID.IM-03]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-09',
                        title: '[Withdrawn: Moved to ID.IM-04]',
                        summary: '[Withdrawn: Moved to ID.IM-04]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-10',
                        title: '[Withdrawn: Incorporated into ID.IM-02, ID.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.IM-02, ID.IM-04]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-11',
                        title: '[Withdrawn: Moved to GV.RR-04]',
                        summary: '[Withdrawn: Moved to GV.RR-04]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IP-12',
                        title: '[Withdrawn: Incorporated into ID.RA-01, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.RA-01, PR.PS-02]',
                        evidence: ['Category: PR.IP ‚Äî Information Protection Processes and Procedures', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IR-01',
                        title: 'Networks and environments are protected fro‚Ä¶',
                        summary: 'Networks and environments are protected from unauthorized logical access and usage',
                        evidence: ['Category: PR.IR ‚Äî Technology Infrastructure Resilience', 'Example: Logically segment organization networks and cloud-based platforms according to trust boundaries and platform types (e.g., IT, IoT, OT, mobile, guests), and permit required communications only between segments', "Example: Logically segment organization networks from external networks, and permit only necessary communications to enter the organization's networks from the external networks"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IR-02',
                        title: "Organization's technology assets are protec‚Ä¶",
                        summary: "The organization's technology assets are protected from environmental threats",
                        evidence: ['Category: PR.IR ‚Äî Technology Infrastructure Resilience', 'Example: Protect organizational equipment from known environmental threats, such as flooding, fire, wind, and excessive heat and humidity', "Example: Include protection from environmental threats and provisions for adequate operating infrastructure in requirements for service providers that operate systems on the organization's behalf"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IR-03',
                        title: 'Mechanisms are implemented to achieve resil‚Ä¶',
                        summary: 'Mechanisms are implemented to achieve resilience requirements in normal and adverse situations',
                        evidence: ['Category: PR.IR ‚Äî Technology Infrastructure Resilience', 'Example: Avoid single points of failure in systems and infrastructure', 'Example: Use load balancing to increase capacity and improve reliability'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.IR-04',
                        title: 'Adequate resource capacity to ensure availa‚Ä¶',
                        summary: 'Adequate resource capacity to ensure availability is maintained',
                        evidence: ['Category: PR.IR ‚Äî Technology Infrastructure Resilience', 'Example: Monitor usage of storage, power, compute, network bandwidth, and other resources', 'Example: Forecast future needs, and scale resources accordingly'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.MA-01',
                        title: '[Withdrawn: Incorporated into ID.AM-08, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.AM-08, PR.PS-03]',
                        evidence: ['Category: PR.MA ‚Äî Maintenance', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.MA-02',
                        title: '[Withdrawn: Incorporated into ID.AM-08, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.AM-08, PR.PS-02]',
                        evidence: ['Category: PR.MA ‚Äî Maintenance', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PS-01',
                        title: 'Configuration management practices are esta‚Ä¶',
                        summary: 'Configuration management practices are established and applied',
                        evidence: ['Category: PR.PS ‚Äî Platform Security', "Example: Establish, test, deploy, and maintain hardened baselines that enforce the organization's cybersecurity policies and provide only essential capabilities (i.e., principle of least functionality)", 'Example: Review all default configuration settings that may potentially impact cybersecurity when installing or upgrading software'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PS-02',
                        title: 'Software is maintained, replaced, and remov‚Ä¶',
                        summary: 'Software is maintained, replaced, and removed commensurate with risk',
                        evidence: ['Category: PR.PS ‚Äî Platform Security', 'Example: Perform routine and emergency patching within the timeframes specified in the vulnerability management plan', 'Example: Update container images, and deploy new container instances to replace rather than update existing instances'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PS-03',
                        title: 'Hardware is maintained, replaced, and remov‚Ä¶',
                        summary: 'Hardware is maintained, replaced, and removed commensurate with risk',
                        evidence: ['Category: PR.PS ‚Äî Platform Security', 'Example: Replace hardware when it lacks needed security capabilities or when it cannot support software with needed security capabilities', 'Example: Define and implement plans for hardware end-of-life maintenance support and obsolescence'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PS-04',
                        title: 'Log records are generated and made availabl‚Ä¶',
                        summary: 'Log records are generated and made available for continuous monitoring',
                        evidence: ['Category: PR.PS ‚Äî Platform Security', 'Example: Configure all operating systems, applications, and services (including cloud-based services) to generate log records', "Example: Configure log generators to securely share their logs with the organization's logging infrastructure systems and services"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PS-05',
                        title: 'Installation and execution of unauthorized‚Ä¶',
                        summary: 'Installation and execution of unauthorized software are prevented',
                        evidence: ['Category: PR.PS ‚Äî Platform Security', 'Example: When risk warrants it, restrict software execution to permitted products only or deny the execution of prohibited and unauthorized software', "Example: Verify the source of new software and the software's integrity before installing it"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PS-06',
                        title: 'Secure software development practices are i‚Ä¶',
                        summary: 'Secure software development practices are integrated, and their performance is monitored throughout the software development life cycle',
                        evidence: ['Category: PR.PS ‚Äî Platform Security', 'Example: Protect all components of organization-developed software from tampering and unauthorized access', 'Example: Secure all software produced by the organization, with minimal vulnerabilities in their releases'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PT-01',
                        title: '[Withdrawn: Incorporated into PR.PS-04]',
                        summary: '[Withdrawn: Incorporated into PR.PS-04]',
                        evidence: ['Category: PR.PT ‚Äî Protective Technology', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PT-02',
                        title: '[Withdrawn: Incorporated into PR.DS-01, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into PR.DS-01, PR.PS-01]',
                        evidence: ['Category: PR.PT ‚Äî Protective Technology', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PT-03',
                        title: '[Withdrawn: Incorporated into PR.PS-01]',
                        summary: '[Withdrawn: Incorporated into PR.PS-01]',
                        evidence: ['Category: PR.PT ‚Äî Protective Technology', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PT-04',
                        title: '[Withdrawn: Incorporated into PR.AA-06, PR.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into PR.AA-06, PR.IR-01]',
                        evidence: ['Category: PR.PT ‚Äî Protective Technology', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'PR.PT-05',
                        title: '[Withdrawn: Moved to PR.IR-03]',
                        summary: '[Withdrawn: Moved to PR.IR-03]',
                        evidence: ['Category: PR.PT ‚Äî Protective Technology', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    }
                ]
            },
            {
                id: 'de',
                title: 'DETECT (DE)',
                policyRef: 'NIST CSF 2.0 Core',
                requirements: [
                    {
                        id: 'DE.AE-01',
                        title: '[Withdrawn: Incorporated into ID.AM-03]',
                        summary: '[Withdrawn: Incorporated into ID.AM-03]',
                        evidence: ['Category: DE.AE ‚Äî Adverse Event Analysis', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.AE-02',
                        title: 'Potentially adverse events are analyzed to‚Ä¶',
                        summary: 'Potentially adverse events are analyzed to better understand associated activities',
                        evidence: ['Category: DE.AE ‚Äî Adverse Event Analysis', 'Example: Use security information and event management (SIEM) or other tools to continuously monitor log events for known malicious and suspicious activity', 'Example: Utilize up-to-date cyber threat intelligence in log analysis tools to improve detection accuracy and characterize threat actors, their methods, and indicators of compromise'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.AE-03',
                        title: 'Information is correlated from multiple sou‚Ä¶',
                        summary: 'Information is correlated from multiple sources',
                        evidence: ['Category: DE.AE ‚Äî Adverse Event Analysis', 'Example: Constantly transfer log data generated by other sources to a relatively small number of log servers', 'Example: Use event correlation technology (e.g., SIEM) to collect information captured by multiple sources'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.AE-04',
                        title: 'Estimated impact and scope of adverse event‚Ä¶',
                        summary: 'The estimated impact and scope of adverse events are understood',
                        evidence: ['Category: DE.AE ‚Äî Adverse Event Analysis', 'Example: Use SIEMs or other tools to estimate impact and scope, and review and refine the estimates', 'Example: A person creates their own estimates of impact and scope'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.AE-05',
                        title: '[Withdrawn: Moved to DE.AE-08]',
                        summary: '[Withdrawn: Moved to DE.AE-08]',
                        evidence: ['Category: DE.AE ‚Äî Adverse Event Analysis', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.AE-06',
                        title: 'Information on adverse events is provided t‚Ä¶',
                        summary: 'Information on adverse events is provided to authorized staff and tools',
                        evidence: ['Category: DE.AE ‚Äî Adverse Event Analysis', 'Example: Use cybersecurity software to generate alerts and provide them to the security operations center (SOC), incident responders, and incident response tools', 'Example: Incident responders and other authorized personnel can access log analysis findings at all times'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.AE-07',
                        title: 'Cyber threat intelligence and other context‚Ä¶',
                        summary: 'Cyber threat intelligence and other contextual information are integrated into the analysis',
                        evidence: ['Category: DE.AE ‚Äî Adverse Event Analysis', 'Example: Securely provide cyber threat intelligence feeds to detection technologies, processes, and personnel', 'Example: Securely provide information from asset inventories to detection technologies, processes, and personnel'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.AE-08',
                        title: 'Incidents are declared when adverse events‚Ä¶',
                        summary: 'Incidents are declared when adverse events meet the defined incident criteria',
                        evidence: ['Category: DE.AE ‚Äî Adverse Event Analysis', 'Example: Apply incident criteria to known and assumed characteristics of activity in order to determine whether an incident should be declared', 'Example: Take known false positives into account when applying incident criteria'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-01',
                        title: 'Networks and network services are monitored‚Ä¶',
                        summary: 'Networks and network services are monitored to find potentially adverse events',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: Monitor DNS, BGP, and other network services for adverse events', 'Example: Monitor wired and wireless networks for connections from unauthorized endpoints'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-02',
                        title: 'Physical environment is monitored to find p‚Ä¶',
                        summary: 'The physical environment is monitored to find potentially adverse events',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: Monitor logs from physical access control systems (e.g., badge readers) to find unusual access patterns (e.g., deviations from the norm) and failed access attempts', 'Example: Review and monitor physical access records (e.g., from visitor registration, sign-in sheets)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-03',
                        title: 'Personnel activity and technology usage are‚Ä¶',
                        summary: 'Personnel activity and technology usage are monitored to find potentially adverse events',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: Use behavior analytics software to detect anomalous user activity to mitigate insider threats', 'Example: Monitor logs from logical access control systems to find unusual access patterns and failed access attempts'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-04',
                        title: '[Withdrawn: Incorporated into DE.CM-01, DE.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into DE.CM-01, DE.CM-09]',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-05',
                        title: '[Withdrawn: Incorporated into DE.CM-01, DE.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into DE.CM-01, DE.CM-09]',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-06',
                        title: 'External service provider activities and se‚Ä¶',
                        summary: 'External service provider activities and services are monitored to find potentially adverse events',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: Monitor remote and onsite administration and maintenance activities that external providers perform on organizational systems', 'Example: Monitor activity from cloud-based services, internet service providers, and other service providers for deviations from expected behavior'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-07',
                        title: '[Withdrawn: Incorporated into DE.CM-01, DE.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into DE.CM-01, DE.CM-03, DE.CM-06, DE.CM-09]',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-08',
                        title: '[Withdrawn: Incorporated into ID.RA-01]',
                        summary: '[Withdrawn: Incorporated into ID.RA-01]',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.CM-09',
                        title: 'Computing hardware and software, runtime en‚Ä¶',
                        summary: 'Computing hardware and software, runtime environments, and their data are monitored to find potentially adverse events',
                        evidence: ['Category: DE.CM ‚Äî Continuous Monitoring', 'Example: Monitor email, web, file sharing, collaboration services, and other common attack vectors to detect malware, phishing, data leaks and exfiltration, and other adverse events', 'Example: Monitor authentication attempts to identify attacks against credentials and unauthorized credential reuse'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.DP-01',
                        title: '[Withdrawn: Incorporated into GV.RR-02]',
                        summary: '[Withdrawn: Incorporated into GV.RR-02]',
                        evidence: ['Category: DE.DP ‚Äî Detection Processes', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.DP-02',
                        title: '[Withdrawn: Incorporated into DE.AE]',
                        summary: '[Withdrawn: Incorporated into DE.AE]',
                        evidence: ['Category: DE.DP ‚Äî Detection Processes', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.DP-03',
                        title: '[Withdrawn: Incorporated into ID.IM-02]',
                        summary: '[Withdrawn: Incorporated into ID.IM-02]',
                        evidence: ['Category: DE.DP ‚Äî Detection Processes', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.DP-04',
                        title: '[Withdrawn: Incorporated into DE.AE-06]',
                        summary: '[Withdrawn: Incorporated into DE.AE-06]',
                        evidence: ['Category: DE.DP ‚Äî Detection Processes', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'DE.DP-05',
                        title: '[Withdrawn: Incorporated into ID.IM, ID.IM-‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.IM, ID.IM-03]',
                        evidence: ['Category: DE.DP ‚Äî Detection Processes', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    }
                ]
            },
            {
                id: 'rs',
                title: 'RESPOND (RS)',
                policyRef: 'NIST CSF 2.0 Core',
                requirements: [
                    {
                        id: 'RS.AN-01',
                        title: '[Withdrawn: Incorporated into RS.MA-02]',
                        summary: '[Withdrawn: Incorporated into RS.MA-02]',
                        evidence: ['Category: RS.AN ‚Äî Incident Analysis', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.AN-02',
                        title: '[Withdrawn: Incorporated into RS.MA-02, RS.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into RS.MA-02, RS.MA-03, RS.MA-04]',
                        evidence: ['Category: RS.AN ‚Äî Incident Analysis', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.AN-03',
                        title: 'Analysis is performed to establish what has‚Ä¶',
                        summary: 'Analysis is performed to establish what has taken place during an incident and the root cause of the incident',
                        evidence: ['Category: RS.AN ‚Äî Incident Analysis', 'Example: Determine the sequence of events that occurred during the incident and which assets and resources were involved in each event', 'Example: Attempt to determine what vulnerabilities, threats, and threat actors were directly or indirectly involved in the incident'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.AN-04',
                        title: '[Withdrawn: Moved to RS.MA-03]',
                        summary: '[Withdrawn: Moved to RS.MA-03]',
                        evidence: ['Category: RS.AN ‚Äî Incident Analysis', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.AN-05',
                        title: '[Withdrawn: Moved to ID.RA-08]',
                        summary: '[Withdrawn: Moved to ID.RA-08]',
                        evidence: ['Category: RS.AN ‚Äî Incident Analysis', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.AN-06',
                        title: 'Actions performed during an investigation a‚Ä¶',
                        summary: "Actions performed during an investigation are recorded, and the records' integrity and provenance are preserved",
                        evidence: ['Category: RS.AN ‚Äî Incident Analysis', 'Example: Require each incident responder and others (e.g., system administrators, cybersecurity engineers) who perform incident response tasks to record their actions and make the record immutable', 'Example: Require the incident lead to document the incident in detail and be responsible for preserving the integrity of the documentation and the sources of all information being reported'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.AN-07',
                        title: 'Incident data and metadata are collected, a‚Ä¶',
                        summary: 'Incident data and metadata are collected, and their integrity and provenance are preserved',
                        evidence: ['Category: RS.AN ‚Äî Incident Analysis', 'Example: Collect, preserve, and safeguard the integrity of all pertinent incident data and metadata (e.g., data source, date/time of collection) based on evidence preservation and chain-of-custody procedures'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.AN-08',
                        title: "An incident's magnitude is estimated and va‚Ä¶",
                        summary: "An incident's magnitude is estimated and validated",
                        evidence: ['Category: RS.AN ‚Äî Incident Analysis', 'Example: Review other potential targets of the incident to search for indicators of compromise and evidence of persistence', 'Example: Automatically run tools on targets to look for indicators of compromise and evidence of persistence'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.CO-01',
                        title: '[Withdrawn: Incorporated into PR.AT-01]',
                        summary: '[Withdrawn: Incorporated into PR.AT-01]',
                        evidence: ['Category: RS.CO ‚Äî Incident Response Reporting and Communication', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.CO-02',
                        title: 'Internal and external stakeholders are noti‚Ä¶',
                        summary: 'Internal and external stakeholders are notified of incidents',
                        evidence: ['Category: RS.CO ‚Äî Incident Response Reporting and Communication', "Example: Follow the organization's breach notification procedures after discovering a data breach incident, including notifying affected residents/customers", 'Example: Notify business partners and residents/customers of incidents in accordance with contractual requirements'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.CO-03',
                        title: 'Information is shared with designated inter‚Ä¶',
                        summary: 'Information is shared with designated internal and external stakeholders',
                        evidence: ['Category: RS.CO ‚Äî Incident Response Reporting and Communication', 'Example: Securely share information consistent with response plans and information sharing agreements', "Example: Voluntarily share information about an attacker's observed TTPs, with all sensitive data removed, with an Information Sharing and Analysis Center (ISAC)"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.CO-04',
                        title: '[Withdrawn: Incorporated into RS.MA-01, RS.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into RS.MA-01, RS.MA-04]',
                        evidence: ['Category: RS.CO ‚Äî Incident Response Reporting and Communication', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.CO-05',
                        title: '[Withdrawn: Incorporated into RS.CO-03]',
                        summary: '[Withdrawn: Incorporated into RS.CO-03]',
                        evidence: ['Category: RS.CO ‚Äî Incident Response Reporting and Communication', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.IM-01',
                        title: '[Withdrawn: Incorporated into ID.IM-03, ID.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.IM-03, ID.IM-04]',
                        evidence: ['Category: RS.IM ‚Äî Improvements', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.IM-02',
                        title: '[Withdrawn: Incorporated into ID.IM-03]',
                        summary: '[Withdrawn: Incorporated into ID.IM-03]',
                        evidence: ['Category: RS.IM ‚Äî Improvements', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.MA-01',
                        title: 'Incident response plan is executed in coord‚Ä¶',
                        summary: 'The incident response plan is executed in coordination with relevant third parties once an incident is declared',
                        evidence: ['Category: RS.MA ‚Äî Incident Management', 'Example: Detection technologies automatically report confirmed incidents', "Example: Request incident response assistance from the organization's incident response outsourcer"],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.MA-02',
                        title: 'Incident reports are triaged and validated',
                        summary: 'Incident reports are triaged and validated',
                        evidence: ['Category: RS.MA ‚Äî Incident Management', 'Example: Preliminarily review incident reports to confirm that they are cybersecurity-related and necessitate incident response activities', 'Example: Apply criteria to estimate the severity of an incident'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.MA-03',
                        title: 'Incidents are categorized and prioritized',
                        summary: 'Incidents are categorized and prioritized',
                        evidence: ['Category: RS.MA ‚Äî Incident Management', 'Example: Further review and categorize incidents based on the type of incident (e.g., data breach, ransomware, DDoS, account compromise)', 'Example: Prioritize incidents based on their scope, likely impact, and time-critical nature'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.MA-04',
                        title: 'Incidents are escalated or elevated as need‚Ä¶',
                        summary: 'Incidents are escalated or elevated as needed',
                        evidence: ['Category: RS.MA ‚Äî Incident Management', 'Example: Track and validate the status of all ongoing incidents', 'Example: Coordinate incident escalation or elevation with designated internal and external stakeholders'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.MA-05',
                        title: 'Criteria for initiating incident recovery a‚Ä¶',
                        summary: 'The criteria for initiating incident recovery are applied',
                        evidence: ['Category: RS.MA ‚Äî Incident Management', 'Example: Apply incident recovery criteria to known and assumed characteristics of the incident to determine whether incident recovery processes should be initiated', 'Example: Take the possible operational disruption of incident recovery activities into account'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.MI-01',
                        title: 'Incidents are contained',
                        summary: 'Incidents are contained',
                        evidence: ['Category: RS.MI ‚Äî Incident Mitigation', 'Example: Cybersecurity technologies (e.g., antivirus software) and cybersecurity features of other technologies (e.g., operating systems, network infrastructure devices) automatically perform containment actions', 'Example: Allow incident responders to manually select and perform containment actions'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.MI-02',
                        title: 'Incidents are eradicated',
                        summary: 'Incidents are eradicated',
                        evidence: ['Category: RS.MI ‚Äî Incident Mitigation', 'Example: Cybersecurity technologies and cybersecurity features of other technologies (e.g., operating systems, network infrastructure devices) automatically perform eradication actions', 'Example: Allow incident responders to manually select and perform eradication actions'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.MI-03',
                        title: '[Withdrawn: Incorporated into ID.RA-06]',
                        summary: '[Withdrawn: Incorporated into ID.RA-06]',
                        evidence: ['Category: RS.MI ‚Äî Incident Mitigation', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RS.RP-01',
                        title: '[Withdrawn: Incorporated into RS.MA-01]',
                        summary: '[Withdrawn: Incorporated into RS.MA-01]',
                        evidence: ['Category: RS.RP ‚Äî Response Planning', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    }
                ]
            },
            {
                id: 'rc',
                title: 'RECOVER (RC)',
                policyRef: 'NIST CSF 2.0 Core',
                requirements: [
                    {
                        id: 'RC.CO-01',
                        title: '[Withdrawn: Incorporated into RC.CO-04]',
                        summary: '[Withdrawn: Incorporated into RC.CO-04]',
                        evidence: ['Category: RC.CO ‚Äî Incident Recovery Communication', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.CO-02',
                        title: '[Withdrawn: Incorporated into RC.CO-04]',
                        summary: '[Withdrawn: Incorporated into RC.CO-04]',
                        evidence: ['Category: RC.CO ‚Äî Incident Recovery Communication', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.CO-03',
                        title: 'Recovery activities and progress in restori‚Ä¶',
                        summary: 'Recovery activities and progress in restoring operational capabilities are communicated to designated internal and external stakeholders',
                        evidence: ['Category: RC.CO ‚Äî Incident Recovery Communication', 'Example: Securely share recovery information, including restoration progress, consistent with response plans and information sharing agreements', 'Example: Regularly update senior leadership on recovery status and restoration progress for major incidents'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.CO-04',
                        title: 'Public updates on incident recovery are sha‚Ä¶',
                        summary: 'Public updates on incident recovery are shared using approved methods and messaging',
                        evidence: ['Category: RC.CO ‚Äî Incident Recovery Communication', "Example: Follow the organization's breach notification procedures for recovering from a data breach incident", 'Example: Explain the steps being taken to recover from the incident and to prevent a recurrence'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.IM-01',
                        title: '[Withdrawn: Incorporated into ID.IM-03, ID.‚Ä¶',
                        summary: '[Withdrawn: Incorporated into ID.IM-03, ID.IM-04]',
                        evidence: ['Category: RC.IM ‚Äî Improvements', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.IM-02',
                        title: '[Withdrawn: Incorporated into ID.IM-03]',
                        summary: '[Withdrawn: Incorporated into ID.IM-03]',
                        evidence: ['Category: RC.IM ‚Äî Improvements', 'Example: (see NIST CSF 2.0 Implementation Examples)'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.RP-01',
                        title: 'Recovery portion of the incident response p‚Ä¶',
                        summary: 'The recovery portion of the incident response plan is executed once initiated from the incident response process',
                        evidence: ['Category: RC.RP ‚Äî Incident Recovery Plan Execution', 'Example: Begin recovery procedures during or after incident response processes', 'Example: Make all individuals with recovery responsibilities aware of the plans for recovery and the authorizations required to implement each aspect of the plans'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.RP-02',
                        title: 'Recovery actions are selected, scoped, prio‚Ä¶',
                        summary: 'Recovery actions are selected, scoped, prioritized, and performed',
                        evidence: ['Category: RC.RP ‚Äî Incident Recovery Plan Execution', 'Example: Select recovery actions based on the criteria defined in the incident response plan and available resources', 'Example: Change planned recovery actions based on a reassessment of organizational needs and resources'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.RP-03',
                        title: 'Integrity of backups and other restoration‚Ä¶',
                        summary: 'The integrity of backups and other restoration assets is verified before using them for restoration',
                        evidence: ['Category: RC.RP ‚Äî Incident Recovery Plan Execution', 'Example: Check restoration assets for indicators of compromise, file corruption, and other integrity issues before use'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.RP-04',
                        title: 'Critical mission functions and cyber risk a‚Ä¶',
                        summary: 'Critical mission functions and cybersecurity risk management are considered to establish post-incident operational norms',
                        evidence: ['Category: RC.RP ‚Äî Incident Recovery Plan Execution', 'Example: Use business impact and system categorization records (including service delivery objectives) to validate that essential services are restored in the appropriate order', 'Example: Work with system owners to confirm the successful restoration of systems and the return to normal operations'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.RP-05',
                        title: 'Integrity of restored assets is verified, s‚Ä¶',
                        summary: 'The integrity of restored assets is verified, systems and services are restored, and normal operating status is confirmed',
                        evidence: ['Category: RC.RP ‚Äî Incident Recovery Plan Execution', 'Example: Check restored assets for indicators of compromise and remediation of root causes of the incident before production use', 'Example: Verify the correctness and adequacy of the restoration actions taken before putting a restored system online'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    },
                    {
                        id: 'RC.RP-06',
                        title: 'End of incident recovery is declared based‚Ä¶',
                        summary: 'The end of incident recovery is declared based on criteria, and incident-related documentation is completed',
                        evidence: ['Category: RC.RP ‚Äî Incident Recovery Plan Execution', 'Example: Prepare an after-action report that documents the incident itself, the response and recovery actions taken, and lessons learned', 'Example: Declare the end of incident recovery once the criteria are met'],
                        notesPlaceholder: 'Describe your current approach, gaps, owner, and next step.'
                    }
                ]
            }
        ]
    };

    const stateKey = "nist_csf_2_state";

    function buildStateObject() {
        const data = {
            org: {
                agencyName: document.getElementById("agencyName").value,
                ori: document.getElementById("ori").value,
                csa: document.getElementById("csa").value,
                assessmentDate: document.getElementById("assessmentDate").value,
                assessorName: document.getElementById("assessorName").value,
                assessorEmail: document.getElementById("assessorEmail").value,
                scopeNotes: document.getElementById("scopeNotes").value,
                assessmentType: document.getElementById("assessmentType").value
            },
            contacts: {
                tacName: document.getElementById("tacName").value,
                tacContact: document.getElementById("tacContact").value,
                lasoName: document.getElementById("lasoName").value,
                lasoContact: document.getElementById("lasoContact").value,
                itLead: document.getElementById("itLead").value,
                itContact: document.getElementById("itContact").value,
                tacLasoDocs: getRadioValue("tacLasoDocs"),
                localPolicy: getRadioValue("localPolicy")
            },
            environment: {
                approxUsers: document.getElementById("approxUsers").value,
                cjisSystems: document.getElementById("cjisSystems").value,
                environmentNotes: document.getElementById("environmentNotes").value
            },
            risk: {
                immediate: document.getElementById("riskImmediate").value,
                shortTerm: document.getElementById("riskShortTerm").value,
                longTerm: document.getElementById("riskLongTerm").value
            },
            assessor: {
                notes: document.getElementById("assessorNotes").value
            },
            controls: {},
            meta: {
                exportedAt: new Date().toISOString(),
                tool: "nist-csf-2-workbook",
                version: "0.1"
            }
        };

        cjisControls.policyAreas.forEach(area => {
            area.requirements.forEach(req => {
                data.controls[req.id] = getRequirementState(req.id);
            });
        });
        return data;
    }

    function applyStateObject(data) {
        if (!data) return;

        if (data.org) {
            document.getElementById("agencyName").value = data.org.agencyName || "";
            document.getElementById("ori").value = data.org.ori || "";
            document.getElementById("csa").value = data.org.csa || "";
            document.getElementById("assessmentDate").value = data.org.assessmentDate || "";
            document.getElementById("assessorName").value = data.org.assessorName || "";
            document.getElementById("assessorEmail").value = data.org.assessorEmail || "";
            document.getElementById("scopeNotes").value = data.org.scopeNotes || "";
            document.getElementById("assessmentType").value = data.org.assessmentType || "";
        }

        if (data.contacts) {
            document.getElementById("tacName").value = data.contacts.tacName || "";
            document.getElementById("tacContact").value = data.contacts.tacContact || "";
            document.getElementById("lasoName").value = data.contacts.lasoName || "";
            document.getElementById("lasoContact").value = data.contacts.lasoContact || "";
            document.getElementById("itLead").value = data.contacts.itLead || "";
            document.getElementById("itContact").value = data.contacts.itContact || "";
            setRadioValue("tacLasoDocs", data.contacts.tacLasoDocs || "");
            setRadioValue("localPolicy", data.contacts.localPolicy || "");
        }

        if (data.environment) {
            document.getElementById("approxUsers").value = data.environment.approxUsers || "";
            document.getElementById("cjisSystems").value = data.environment.cjisSystems || "";
            document.getElementById("environmentNotes").value = data.environment.environmentNotes || "";
        }

        if (data.risk) {
            document.getElementById("riskImmediate").value = data.risk.immediate || "";
            document.getElementById("riskShortTerm").value = data.risk.shortTerm || "";
            document.getElementById("riskLongTerm").value = data.risk.longTerm || "";
        }

        if (data.assessor) {
            document.getElementById("assessorNotes").value = data.assessor.notes || "";
        }

        if (data.controls) {
            Object.keys(data.controls).forEach(reqId => {
                const ctrl = data.controls[reqId];
                const statusEl = document.getElementById(`status-${reqId}`);
                const notesEl = document.getElementById(`notes-${reqId}`);
                if (statusEl) {
                    statusEl.value = (ctrl && ctrl.status) ? ctrl.status : "";
                    updateStatusPill(reqId, (ctrl && ctrl.status) ? ctrl.status : "");
                }
                if (notesEl) {
                    notesEl.value = (ctrl && ctrl.notes) ? ctrl.notes : "";
                }
            });
        }

        updateSummary();
        recalcSnapshot();
    }

    function downloadText(filename, text) {
        const blob = new Blob([text], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
    }

    function exportJSON() {
        const data = buildStateObject();
        const agency = (data.org && data.org.agencyName) ? data.org.agencyName.trim().replace(/[^a-z0-9\- ]/gi,'').replace(/\s+/g,'-') : 'agency';
        const date = (data.org && data.org.assessmentDate) ? data.org.assessmentDate : new Date().toISOString().slice(0,10);
        const filename = `cjis-v6-self-assessment_${agency}_${date}.json`;
        downloadText(filename, JSON.stringify(data, null, 2));
        showToast('Exported JSON (saved to your device).');
    }

    function importJSON(evt) {
        const file = evt && evt.target && evt.target.files ? evt.target.files[0] : null;
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
            try {
                const data = JSON.parse(reader.result);
                applyStateObject(data);
                localStorage.setItem(stateKey, JSON.stringify(data));
                const now = new Date();
                document.getElementById("lastUpdatedLabel").textContent = `Last updated: ${now.toLocaleString()}`;
                showToast('Imported JSON and restored session.');
            } catch (e) {
                showToast('Import failed: invalid JSON.');
            }
            evt.target.value = '';
        };
        reader.readAsText(file);
    }


    function initialize() {
        buildPolicyTabs();
        // default subgroup tabs for first Function
        if (cjisControls && cjisControls.policyAreas && cjisControls.policyAreas.length) {
            const first = cjisControls.policyAreas[0].id;
            buildSubgroupTabs(first);
            selectSubgroup(first, "all");
        }
        loadState();
        updateSummary();
        recalcSnapshot();
        attachRadioHandlers();
    }

    function buildPolicyTabs() {
        const tabContainer = document.getElementById("policyTabs");
        const contentContainer = document.getElementById("policyContent");
        tabContainer.innerHTML = "";
        contentContainer.innerHTML = "";

        cjisControls.policyAreas.forEach((area, index) => {
            const tab = document.createElement("div");
            tab.className = "tab" + (index === 0 ? " active" : "");
            const count = area.requirements ? area.requirements.length : 0;
            tab.textContent = `${area.title} (${count})`;
            tab.dataset.areaId = area.id;
            tab.onclick = () => selectPolicyArea(area.id);
            tabContainer.appendChild(tab);

            const pane = document.createElement("div");
            pane.id = `policy-pane-${area.id}`;
            pane.style.display = index === 0 ? "block" : "none";

            const headerRow = document.createElement("div");
            headerRow.className = "flex-space";
            headerRow.style.marginBottom = "6px";

            const left = document.createElement("div");
            left.innerHTML = `
                <span class="pill-cjis">
                    <span class="pill-cjis-dot"></span>
                    <span class="pill-cjis-code">${area.title}</span>
                    <span class="pill-cjis-area">${area.policyRef || ""}</span>
                </span>
            `;
            headerRow.appendChild(left);

            const right = document.createElement("div");
            right.className = "phase-row";
            right.innerHTML = `
                <div class="phase-badge">
                    <span>‚áß</span> Capture status
                </div>
                <div class="phase-badge">
                    <span>‚òÖ</span> Note gaps
                </div>
                <div class="phase-badge">
                    <span>‚öô</span> Plan fixes
                </div>
            `;
            headerRow.appendChild(right);

            pane.appendChild(headerRow);

            area.requirements.forEach(req => {
                const row = document.createElement("div");
                row.className = "requirement-row";
                row.dataset.reqId = req.id;
                row.dataset.catCode = (req.id && req.id.includes("-")) ? req.id.split("-")[0] : "";

                const header = document.createElement("div");
                header.className = "requirement-header";

                const title = document.createElement("div");
                title.className = "requirement-title";
                title.textContent = req.title;
                header.appendChild(title);

                const idTag = document.createElement("div");
                idTag.className = "requirement-id";
                idTag.textContent = req.id.toUpperCase();
                header.appendChild(idTag);

                const statusPill = document.createElement("div");
                statusPill.className = "pill-status pill-status-muted";
                statusPill.id = `status-pill-${req.id}`;
                statusPill.innerHTML = `
                    <div class="pill-status-dot"></div>
                    <span>Status: Not set</span>
                `;
                header.appendChild(statusPill);

                row.appendChild(header);

                const body = document.createElement("div");
                body.className = "requirement-body";

                const leftCol = document.createElement("div");
                leftCol.className = "requirement-notes";
                leftCol.innerHTML = `
                    <div class="help-text">
                        <strong>Summary:</strong> ${req.summary}
                    </div>
                    <div class="field-label" style="margin-top:4px;"><span>Assessor Notes</span></div>
                    <textarea id="notes-${req.id}" placeholder="${req.notesPlaceholder || ""}"></textarea>
                `;
                body.appendChild(leftCol);

                const rightCol = document.createElement("div");
                rightCol.className = "requirement-controls";

                const statusRow = document.createElement("div");
                statusRow.className = "status-row";
                statusRow.innerHTML = `
                    <select class="status-select" id="status-${req.id}" onchange="onStatusChange('${req.id}')">
                        <option value="">Set tier‚Ä¶</option>
                        <option value="tier1">Tier 1 ‚Äî Partial</option>
                        <option value="tier2">Tier 2 ‚Äî Risk Informed</option>
                        <option value="tier3">Tier 3 ‚Äî Repeatable</option>
                        <option value="tier4">Tier 4 ‚Äî Adaptive</option>
                        <option value="na">Not applicable</option>
                    </select>
                    <span class="pill-text">Use tiers as a plain-language maturity signal for how consistently this outcome is achieved.</span>
                `;
                rightCol.appendChild(statusRow);

                const evidenceRow = document.createElement("div");
                evidenceRow.className = "evidence-tags";

                req.evidence.forEach(ev => {
                    const tag = document.createElement("div");
                    tag.className = "evidence-tag";
                    tag.innerHTML = `<strong>Evidence:</strong> ${ev}`;
                    evidenceRow.appendChild(tag);
                });

                rightCol.appendChild(evidenceRow);

                body.appendChild(rightCol);
                row.appendChild(body);

                pane.appendChild(row);
            });

            contentContainer.appendChild(pane);
        });
    }

    function buildSubgroupTabs(areaId) {
        const container = document.getElementById("subgroupTabs");
        if (!container) return;
        container.innerHTML = "";

        const area = cjisControls.policyAreas.find(a => a.id === areaId);
        if (!area) return;

        const codes = Array.from(new Set(area.requirements.map(r => {
            if (!r || !r.id) return "";
            return r.id.includes("-") ? r.id.split("-")[0] : "";
        }).filter(Boolean))).sort();

        const makeTab = (code, label) => {
            const tab = document.createElement("div");
            tab.className = "tab" + (code === "all" ? " active" : "");
            tab.textContent = label;
            tab.dataset.subgroup = code;
            tab.onclick = () => selectSubgroup(areaId, code);
            container.appendChild(tab);
        };

        const total = area.requirements.length;

        makeTab("all", `All (${total})`);
        codes.forEach(c => {
            const count = area.requirements.filter(r => r && r.id && r.id.startsWith(c + '-')).length;
            makeTab(c, `${c} (${count})`);
        });
    }

    function selectSubgroup(areaId, code) {
        const container = document.getElementById("subgroupTabs");
        if (container) {
            container.querySelectorAll(".tab").forEach(t => {
                t.classList.toggle("active", t.dataset.subgroup === code);
            });
        }

        const pane = document.getElementById(`policy-pane-${areaId}`);
        if (!pane) return;

        pane.querySelectorAll(".requirement-row").forEach(row => {
            if (code === "all") {
                row.style.display = "block";
                return;
            }
            row.style.display = (row.dataset.catCode === code) ? "block" : "none";
        });
    }

    function selectPolicyArea(areaId) {
        document.querySelectorAll(".tab").forEach(tab => {
            tab.classList.toggle("active", tab.dataset.areaId === areaId);
        });

        cjisControls.policyAreas.forEach(area => {
            const pane = document.getElementById(`policy-pane-${area.id}`);
            if (pane) {
                pane.style.display = (area.id === areaId) ? "block" : "none";
            }
        });

        buildSubgroupTabs(areaId);
        selectSubgroup(areaId, "all");
    }

    function onStatusChange(reqId) {
        const status = document.getElementById(`status-${reqId}`).value;
        updateStatusPill(reqId, status);
        recalcSnapshot();
        updateSummary();
    }

    function updateStatusPill(reqId, status) {
        const pill = document.getElementById(`status-pill-${reqId}`);
        if (!pill) return;

        pill.className = "pill-status";
        let text = "Status: Not set";

        if (!status) {
            pill.classList.add("pill-status-muted");
        } else if (status === "tier4") {
            pill.classList.add("pill-status-ok");
            text = "Tier 4: Adaptive";
        } else if (status === "tier3") {
            pill.classList.add("pill-status-ok");
            text = "Tier 3: Repeatable";
        } else if (status === "tier2") {
            pill.classList.add("pill-status-warn");
            text = "Tier 2: Risk Informed";
        } else if (status === "tier1") {
            pill.classList.add("pill-status-risk");
            text = "Tier 1: Partial";
        }  else if (status === "na") {
            pill.classList.add("pill-status-muted");
            text = "Status: Not applicable";
        }

        pill.innerHTML = `
            <div class="pill-status-dot"></div>
            <span>${text}</span>
        `;
    }

    function getRequirementState(reqId) {
        const statusEl = document.getElementById(`status-${reqId}`);
        const notesEl = document.getElementById(`notes-${reqId}`);

        return {
            status: statusEl ? statusEl.value : "",
            notes: notesEl ? notesEl.value : ""
        };
    }

    function recalcSnapshot() {
        let total = 0;
        let withStatus = 0;
        let tier1 = 0;

        cjisControls.policyAreas.forEach(area => {
            area.requirements.forEach(req => {
                total++;
                const status = getRequirementState(req.id).status;
                if (status) withStatus++;
                if (status === "tier1") tier1++;
            });
        });

        const pctComplete = total > 0 ? Math.round((withStatus / total) * 100) : 0;
        const pctRisk = total > 0 ? Math.round((tier1 / total) * 100) : 0;

        document.getElementById("metricComplete").textContent = `${withStatus} / ${total}`;
        document.getElementById("metricNonCompliant").textContent = tier1.toString();
        document.getElementById("progressFill").style.width = `${pctComplete}%`;
        document.getElementById("riskFill").style.width = `${pctRisk}%`;

        const dot = document.getElementById("overallStatusDot");
        const label = document.getElementById("overallStatusLabel");
        const snapshotTag = document.getElementById("snapshotStatusTag");

        dot.className = "pill-dot";
        snapshotTag.className = "tag-soft neutral";

        if (withStatus === 0) {
            dot.classList.add("muted");
            label.textContent = "Not started";
            snapshotTag.textContent = "Not started";
        } else if (tier1 === 0 && pctComplete === 100) {
            dot.classList.add("success");
            label.textContent = "Green ‚Äì No Tier 1 subcategories noted";
            snapshotTag.className = "tag-soft green";
            snapshotTag.textContent = "Green (no Tier 1)";
        } else if (tier1 === 0) {
            dot.classList.add("warning");
            label.textContent = "In progress ‚Äì No Tier 1 subcategories yet";
            snapshotTag.className = "tag-soft yellow";
            snapshotTag.textContent = "In progress ‚Äì no Tier 1";
        } else if (tier1 <= 3) {
            dot.classList.add("warning");
            label.textContent = `Moderate risk ‚Äì ${tier1} Tier 1 subcategories`;
            snapshotTag.className = "tag-soft yellow";
            snapshotTag.textContent = `${tier1} Tier 1 subcategories`;
        } else {
            dot.classList.add("danger");
            label.textContent = `Elevated risk ‚Äì ${tier1} Tier 1 subcategories`;
            snapshotTag.className = "tag-soft red";
            snapshotTag.textContent = `Elevated risk ‚Äì ${tier1} Tier 1 subcategories`;
        }
    }

    function updateSummary() {
        const summaryGrid = document.getElementById("summaryGrid");
        summaryGrid.innerHTML = "";

        cjisControls.policyAreas.forEach(area => {
            const total = area.requirements.length;
            let tier4 = 0, tier3 = 0, tier2 = 0, tier1 = 0, na = 0, pending = 0;

            area.requirements.forEach(req => {
                const status = getRequirementState(req.id).status;
                if (status === "tier4") tier4++;
                else if (status === "tier3") tier3++;
                else if (status === "tier2") tier2++;
                else if (status === "tier1") tier1++;
                else if (status === "na") na++;
                else pending++;
            });

            const completed = total - pending;
            const completionRate = total === 0 ? 0 : Math.round((completed / total) * 100);

            const card = document.createElement("div");
            card.className = "summary-card";
            card.innerHTML = `
                <h4>${area.title}</h4>
                <div>
                    <div class="summary-card-row">
                        <span>Tier 4 (Adaptive):</span>
                        <span style="color:#166534;">${tier4}</span>
                    </div>
                    <div class="summary-card-row">
                        <span>Tier 3 (Repeatable):</span>
                        <span style="color:#166534;">${tier3}</span>
                    </div>
                    <div class="summary-card-row">
                        <span>Tier 2 (Risk Informed):</span>
                        <span style="color:#854d0e;">${tier2}</span>
                    </div>
                    <div class="summary-card-row">
                        <span>Tier 1 (Partial):</span>
                        <span style="color:#b91c1c;">${tier1}</span>
                    </div>
                    <div class="summary-card-row">
                        <span>N/A:</span>
                        <span style="color:#374151;">${na}</span>
                    </div>
                    <div class="summary-card-row">
                        <span>Pending:</span>
                        <span style="color:#0b61a4;">${pending}</span>
                    </div>
                    <div class="summary-completion">
                        Completion: ${completionRate}% (${completed}/${total} with a tier)
                    </div>
                    <div class="progress-bar" style="margin-top:6px;">
                        <div class="progress-fill" style="width:${completionRate}%;"></div>
                    </div>
                </div>
            `;

            summaryGrid.appendChild(card);
        });
    }

    function saveState() {
        const data = buildStateObject();
        try {
            localStorage.setItem(stateKey, JSON.stringify(data));
            const now = new Date();
            const stamp = now.toLocaleString();
            document.getElementById("lastUpdatedLabel").textContent = `Last updated: ${stamp}`;
            showToast("Assessment state saved in this browser.");
        } catch (e) {
            showToast("Unable to save ‚Äì local browser storage may be disabled.");
        }
    }

    function loadState() {
        try {
            const raw = localStorage.getItem(stateKey);
            if (!raw) return;
            const data = JSON.parse(raw);

            if (data.org) {
                document.getElementById("agencyName").value = data.org.agencyName || "";
                document.getElementById("ori").value = data.org.ori || "";
                document.getElementById("csa").value = data.org.csa || "";
                document.getElementById("assessmentDate").value = data.org.assessmentDate || "";
                document.getElementById("assessorName").value = data.org.assessorName || "";
                document.getElementById("assessorEmail").value = data.org.assessorEmail || "";
                document.getElementById("scopeNotes").value = data.org.scopeNotes || "";
                document.getElementById("assessmentType").value = data.org.assessmentType || "";
            }

            if (data.contacts) {
                document.getElementById("tacName").value = data.contacts.tacName || "";
                document.getElementById("tacContact").value = data.contacts.tacContact || "";
                document.getElementById("lasoName").value = data.contacts.lasoName || "";
                document.getElementById("lasoContact").value = data.contacts.lasoContact || "";
                document.getElementById("itLead").value = data.contacts.itLead || "";
                document.getElementById("itContact").value = data.contacts.itContact || "";
                setRadioValue("tacLasoDocs", data.contacts.tacLasoDocs || "");
                setRadioValue("localPolicy", data.contacts.localPolicy || "");
            }

            if (data.environment) {
                document.getElementById("approxUsers").value = data.environment.approxUsers || "";
                document.getElementById("cjisSystems").value = data.environment.cjisSystems || "";
                document.getElementById("environmentNotes").value = data.environment.environmentNotes || "";
            }

            if (data.risk) {
                document.getElementById("riskImmediate").value = data.risk.immediate || "";
                document.getElementById("riskShortTerm").value = data.risk.shortTerm || "";
                document.getElementById("riskLongTerm").value = data.risk.longTerm || "";
            }

            if (data.assessor) {
                document.getElementById("assessorNotes").value = data.assessor.notes || "";
            }

            if (data.controls) {
                Object.keys(data.controls).forEach(reqId => {
                    const ctrl = data.controls[reqId];
                    const statusEl = document.getElementById(`status-${reqId}`);
                    const notesEl = document.getElementById(`notes-${reqId}`);
                    if (statusEl) {
                        statusEl.value = ctrl.status || "";
                        updateStatusPill(reqId, ctrl.status || "");
                    }
                    if (notesEl) {
                        notesEl.value = ctrl.notes || "";
                    }
                });
            }

        } catch (e) {
            console.error("Error loading state", e);
        }
    }

    function resetState() {
        if (!confirm("Clear all assessment inputs for this page in this browser?")) return;
        localStorage.removeItem(stateKey);
        location.reload();
    }

    function getRadioValue(name) {
        const radios = document.querySelectorAll(`input[name="${name}"]`);
        for (let r of radios) {
            if (r.checked) return r.value;
        }
        return "";
    }

    function setRadioValue(name, value) {
        const radios = document.querySelectorAll(`input[name="${name}"]`);
        radios.forEach(r => {
            r.checked = (r.value === value);
        });
    }

    let toastTimer = null;

    function showToast(message) {
        const toast = document.getElementById("toast");
        const text = document.getElementById("toastText");
        text.textContent = message;
        toast.classList.add("show");

        if (toastTimer) {
            clearTimeout(toastTimer);
        }
        toastTimer = setTimeout(() => {
            toast.classList.remove("show");
        }, 2800);
    }

    const controlModalContent = {
        governance: {
            title: "Suggested Evidence (Governance, Policy, Vendors)",
            body: `
                <p class="text-sm">
                    Governance documentation is critical to show how the organization manages cybersecurity risk and assigns responsibility.
organization organizes CSF responsibilities.
                </p>
                <h4>Core Governance Artifacts</h4>
                <ul>
                    <li>Evidence of assigned roles/responsibilities and points of contact</li>
                    <li>Local CSF Security Policy or SOPs referencing CSF 2.0</li>
                    <li>Organizational chart highlighting CSF-related roles</li>
                    <li>Role & responsibility matrix (Leadership, IT, HR, Finance, Vendors)</li>
                </ul>
                <h4>Helpful Support Documents</h4>
                <ul>
                    <li>Meeting notes where CSF topics are discussed with leadership</li>
                    <li>Communications from CSA or state CSF office that have been incorporated locally</li>
                    <li>Any written tasking documents defining CSF-related duties</li>
                </ul>
                <p class="text-sm mt-4">
                    <strong>Tip:</strong> Use a simple matrix listing CSF functions down the left and the responsible role across the top
                    to make responsibilities clear and easy to review during audits.
                </p>
            `
        }
    };

    function openControlModal(key) {
        const cfg = controlModalContent[key];
        if (!cfg) return;

        document.getElementById("controlModalTitle").textContent = cfg.title;
        document.getElementById("controlModalBody").innerHTML = cfg.body;
        document.getElementById("controlModalBackdrop").style.display = "flex";
    }

    function closeControlModal() {
        document.getElementById("controlModalBackdrop").style.display = "none";
    }

    function attachRadioHandlers() {
        document.querySelectorAll('input[type="radio"]').forEach(r => {
            r.addEventListener("change", () => {
                recalcSnapshot();
            });
        });
    }

    document.addEventListener("DOMContentLoaded", initialize);
</script>
</body>
</html>
